<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.135.0"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Tom's Blog</title>
<meta name=description content><meta name=author content><link rel=canonical href=https://tomaugspurger.net/><link crossorigin=anonymous href=/assets/css/stylesheet.ced21e6d3497ee93fed8f8b357448095840179bd510b5ea0e6013078712e6dd1.css integrity="sha256-ztIebTSX7pP+2PizV0SAlYQBeb1RC16g5gEweHEubdE=" rel="preload stylesheet" as=style><link rel=icon href=https://tomaugspurger.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tomaugspurger.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tomaugspurger.net/favicon-32x32.png><link rel=apple-touch-icon href=https://tomaugspurger.net/apple-touch-icon.png><link rel=mask-icon href=https://tomaugspurger.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://tomaugspurger.net/index.xml><link rel=alternate hreflang=en href=https://tomaugspurger.net/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Tom's Blog"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://tomaugspurger.net/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Tom's Blog"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Tom's Blog","url":"https://tomaugspurger.net/","description":"","thumbnailUrl":"https://tomaugspurger.net/favicon.ico","sameAs":["https://github.com/TomAugspurger","index.xml"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tomaugspurger.net/ accesskey=h title="Tom's Blog (Alt + H)">Tom's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://tomaugspurger.net/about/ title=About><span>About</span></a></li><li><a href=https://tomaugspurger.net/archives title=Archive><span>Archive</span></a></li><li><a href=https://tomaugspurger.net/index.xml title=RSS><span>RSS</span></a></li><li><a href=https://tomaugspurger.net/tags title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>What's Next? (2024 edition)</h2></header><div class=entry-content><p>I have, as they say, some personal news to share. On Monday I (along with some very talented teammates, see below if you’re hiring) was laid off from Microsoft as part of a reorganization. Like my Moving to Microsoft post, I wanted to jot down some of the things I got to work on.
For those of you wondering, the Planetary Computer project does continue, just without me.
Reflections It should go without saying that all of this was a team effort. I’ve been incredibly fortunate to have great teammates over the years, but the team building out the Planetary Computer was especially fantastic. Just like before, this will be very self-centered and project-focused, overlooking all the other people and work that went into this.
...</p></div><footer class=entry-footer><span title='2024-08-12 07:00:00 -0500 -0500'>August 12, 2024</span></footer><a class=entry-link aria-label="post link to What's Next? (2024 edition)" href=https://tomaugspurger.net/posts/leaving-microsoft/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>My Real-World Match / Case</h2></header><div class=entry-content><p>Ned Batchelder recently shared Real-world match/case, showing a real example of Python’s Structural Pattern Matching. These real-world examples are a great complement to the tutorial, so I’ll share mine.
While working on some STAC + Kerchunk stuff, in this pull request I used the match statement to parse some nested objects:
for k, v in refs.items(): match k.split("/"): case [".zgroup"]: # k = ".zgroup" item.properties["kerchunk:zgroup"] = json.loads(v) case [".zattrs"]: # k = ".zattrs" item.properties["kerchunk:zattrs"] = json.loads(v) case [variable, ".zarray"]: # k = "prcp/.zarray" if u := item.properties["cube:dimensions"].get(variable): u["kerchunk:zarray"] = json.loads(refs[k]) elif u := item.properties["cube:variables"].get(variable): u["kerchunk:zarray"] = json.loads(refs[k]) case [variable, ".zattrs"]: # k = "prcp/.zattrs" if u := item.properties["cube:dimensions"].get(variable): u["kerchunk:zattrs"] = json.loads(refs[k]) elif u := item.properties["cube:variables"].get(variable): u["kerchunk:zattrs"] = json.loads(refs[k]) case [variable, index]: # k = "prcp/0.0.0" if u := item.properties["cube:dimensions"].get(variable): u.setdefault("kerchunk:value", collections.defaultdict(dict)) u["kerchunk:value"][index] = refs[k] elif u := item.properties["cube:variables"].get(variable): u.setdefault("kerchunk:value", collections.defaultdict(dict)) u["kerchunk:value"][index] = refs[k] The for loop is iterating over a set of Kerchunk references, which are essentially the keys for a Zarr group. The keys vary a bit. They could be:
...</p></div><footer class=entry-footer><span title='2023-12-13 21:00:00 -0600 -0600'>December 13, 2023</span></footer><a class=entry-link aria-label="post link to My Real-World Match / Case" href=https://tomaugspurger.net/posts/my-real-world-match/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>STAC Updates I'm Excited About</h2></header><div class=entry-content><p>I wanted to share an update on a couple of developments in the STAC ecosystem that I’m excited about. It’s a great sign that even after 2 years after its initial release, the STAC ecosystem is still growing and improving how we can catalog, serve, and access geospatial data.
STAC and Geoparquet A STAC API is a great way to query for data. But, like any API serving JSON, its throughput is limited. So in May 2022, the Planetary Computer team decided to export snapshots of our STAC database as geoparquet. Each STAC collection is exported as a Parquet dataset, where each record in the dataset is a STAC item. We pitched this as a way to do bulk queries over the data, where returning many and many pages of JSON would be slow (and expensive for our servers and database).
...</p></div><footer class=entry-footer><span title='2023-10-15 12:00:00 -0500 -0500'>October 15, 2023</span></footer><a class=entry-link aria-label="post link to STAC Updates I'm Excited About" href=https://tomaugspurger.net/posts/stac-updates/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Gone Rafting</h2></header><div class=entry-content><p>Last week, I was fortunate to attend Dave Beazley’s Rafting Trip course. The pretext of the course is to implement the Raft Consensus Algorithm.
I’ll post more about Raft, and the journey of implementing, it later. But in brief, Raft is an algorithm that lets a cluster of machines work together to reliably do something. If you had a service that needed to stay up (and stay consistent), even if some of the machines in the cluster went down, then you might want to use Raft.
...</p></div><footer class=entry-footer><span title='2023-08-13 14:30:19 -0500 -0500'>August 13, 2023</span></footer><a class=entry-link aria-label="post link to Gone Rafting" href=https://tomaugspurger.net/posts/gone-rafting/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>National Water Model on Azure</h2></header><div class=entry-content><p>A few colleagues and I recently presented at the CIROH Training and Developers Conference. In preparation for that I created a Jupyter Book. You can view it at https://tomaugspurger.net/noaa-nwm/intro.html I created a few cloud-optimized versions for subsets of the data, but those will be going away since we don’t have operational pipelines to keep them up to date. But hopefully the static notebooks are still helpful.
Lessons learned Aside from running out of time (I always prepare too much material for the amount of time), I think things went well. JupyterHub (perhaps + Dask) and Kubernetes continues to be a great way to run a workshop.
...</p></div><footer class=entry-footer><span title='2023-05-25 12:04:06 -0500 -0500'>May 25, 2023</span></footer><a class=entry-link aria-label="post link to National Water Model on Azure" href=https://tomaugspurger.net/posts/noaa-nwm/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Jupyter, STAC, and Tool Building</h2></header><div class=entry-content><p>Over in Planetary Computer land, we’re working on bringing Sentinel-5P into our STAC catalog.
STAC items require a geometry property, a GeoJSON object that describes the footprint of the assets. Thanks to the satellites’ orbit and the (spatial) size of the assets, we started with some…interesting… footprints:
That initial footprint, shown in orange, would render the STAC collection essentially useless for spatial searches. The assets don’t actually cover (most of) the southern hemisphere.
...</p></div><footer class=entry-footer><span title='2023-04-15 08:00:00 -0500 -0500'>April 15, 2023</span></footer><a class=entry-link aria-label="post link to Jupyter, STAC, and Tool Building" href=https://tomaugspurger.net/posts/jupyter-stac-browser/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>py-spy in Azure Batch</h2></header><div class=entry-content><p>Today, I was debugging a hanging task in Azure Batch. This short post records how I used py-spy to investigate the problem.
Background Azure Batch is a compute service that we use to run container workloads. In this case, we start up a container that processes a bunch of GOES-GLM data to create STAC items for the Planetary Computer . The workflow is essentially a big
for url in urls: local_file = download_url(url) stac.create_item(local_file) We noticed that some Azure Batch tasks were hanging. Based on our logs, we knew it was somewhere in that for loop, but couldn’t determine exactly where things were hanging. The goes-glm stactools package we used does read a NetCDF file, and my experience with Dask biased me towards thinking the netcdf library (or the HDF5 reader it uses) was hanging. But I wanted to confirm that before trying to implement a fix.
...</p></div><footer class=entry-footer><span title='2023-02-22 15:11:37 -0600 -0600'>February 22, 2023</span></footer><a class=entry-link aria-label="post link to py-spy in Azure Batch" href=https://tomaugspurger.net/posts/azure-batch-pyspy/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Planetary Computer Release: January 2023</h2></header><div class=entry-content><p>The Planetary Computer made its January 2023 release a couple weeks back.
The flagship new feature is a really cool new ability to visualize the Microsoft AI-detected Buildings Footprints dataset. Here’s a little demo made by my teammate, Rob:
Your browser doesn't support HTML video. Here is a link to the video instead. Currently, enabling this feature required converting the data from its native geoparquet to a lot of protobuf files with Tippecanoe. I’m very excited about projects to visualize the geoparquet data directly (see Kyle Barron’s demo) but for now we needed to do the conversion.
...</p></div><footer class=entry-footer><span title='2023-02-09 00:00:00 +0000 UTC'>February 9, 2023</span></footer><a class=entry-link aria-label="post link to Planetary Computer Release: January 2023" href=https://tomaugspurger.net/posts/pc-january-2023/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Cloud Optimized Vibes</h2></header><div class=entry-content><p>Over on the Planetary Computer team, we get to have a lot of fun discussions about doing geospatial data analysis on the cloud. This post summarizes some work we did, and the (I think) interesting conversations that came out of it.
Background: GOES-GLM The instigator in this case was onboarding a new dataset to the Planetary Computer, GOES-GLM. GOES is a set of geostationary weather satellites operated by NOAA, and GLM is the Geostationary Lightning Mapper, an instrument on the satellites that’s used to monitor lightning. It produces some really neat (and valuable) data.
...</p></div><footer class=entry-footer><span title='2023-01-14 16:16:11 -0600 -0600'>January 14, 2023</span></footer><a class=entry-link aria-label="post link to Cloud Optimized Vibes" href=https://tomaugspurger.net/posts/cloud-optimized-quandary/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Queues in the News</h2></header><div class=entry-content><p>I came across a couple of new (to me) uses of queues recently. When I came up with the title to this article I knew I had to write them up together.
Queues in Dask Over at the Coiled Blog, Gabe Joseph has a nice post summarizing a huge amount of effort addressing a problem that’s been vexing demanding Dask users for years. The main symptom of the problem was unexpectedly high memory usage on workers, leading to crashing workers (which in turn caused even more network communication, and so more memory usage, and more crashing workers). This is actually a problem I worked on a bit back in 2019, and I made very little progress.
...</p></div><footer class=entry-footer><span title='2022-12-26 13:35:24 -0600 -0600'>December 26, 2022</span></footer><a class=entry-link aria-label="post link to Queues in the News" href=https://tomaugspurger.net/posts/queues/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://tomaugspurger.net/>«&nbsp;Prev&nbsp;
</a><a class=next href=https://tomaugspurger.net/page/3/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2025 <a href=https://tomaugspurger.net/>Tom's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><a rel=me href=https://mastodon.social/@TomAugspurger></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>