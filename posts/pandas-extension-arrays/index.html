<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Extension Arrays for Pandas | Tom's Blog</title>
<meta name=keywords content="pandas"><meta name=description content="This is a status update on some enhancements for pandas. The goal of the work
is to store things that are sufficiently array-like in a pandas DataFrame,
even if they aren&rsquo;t a regular NumPy array. Pandas already does this in a few
places for some blessed types (like Categorical); we&rsquo;d like to open that up to
anybody.
A couple months ago, a client came to Anaconda with a problem: they
have a bunch of IP Address data that they&rsquo;d like to work with in pandas. They
didn&rsquo;t just want to make a NumPy array of IP addresses for a few reasons:"><meta name=author content><link rel=canonical href=https://tomaugspurger.net/posts/pandas-extension-arrays/><link crossorigin=anonymous href=/assets/css/stylesheet.ced21e6d3497ee93fed8f8b357448095840179bd510b5ea0e6013078712e6dd1.css integrity="sha256-ztIebTSX7pP+2PizV0SAlYQBeb1RC16g5gEweHEubdE=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://tomaugspurger.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tomaugspurger.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tomaugspurger.net/favicon-32x32.png><link rel=apple-touch-icon href=https://tomaugspurger.net/apple-touch-icon.png><link rel=mask-icon href=https://tomaugspurger.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://tomaugspurger.net/posts/pandas-extension-arrays/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Extension Arrays for Pandas"><meta property="og:description" content="This is a status update on some enhancements for pandas. The goal of the work
is to store things that are sufficiently array-like in a pandas DataFrame,
even if they aren&rsquo;t a regular NumPy array. Pandas already does this in a few
places for some blessed types (like Categorical); we&rsquo;d like to open that up to
anybody.
A couple months ago, a client came to Anaconda with a problem: they
have a bunch of IP Address data that they&rsquo;d like to work with in pandas. They
didn&rsquo;t just want to make a NumPy array of IP addresses for a few reasons:"><meta property="og:type" content="article"><meta property="og:url" content="https://tomaugspurger.net/posts/pandas-extension-arrays/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-02-12T00:00:00+00:00"><meta property="article:modified_time" content="2018-02-12T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Extension Arrays for Pandas"><meta name=twitter:description content="This is a status update on some enhancements for pandas. The goal of the work
is to store things that are sufficiently array-like in a pandas DataFrame,
even if they aren&rsquo;t a regular NumPy array. Pandas already does this in a few
places for some blessed types (like Categorical); we&rsquo;d like to open that up to
anybody.
A couple months ago, a client came to Anaconda with a problem: they
have a bunch of IP Address data that they&rsquo;d like to work with in pandas. They
didn&rsquo;t just want to make a NumPy array of IP addresses for a few reasons:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://tomaugspurger.net/posts/"},{"@type":"ListItem","position":2,"name":"Extension Arrays for Pandas","item":"https://tomaugspurger.net/posts/pandas-extension-arrays/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Extension Arrays for Pandas","name":"Extension Arrays for Pandas","description":"This is a status update on some enhancements for pandas. The goal of the work is to store things that are sufficiently array-like in a pandas DataFrame, even if they aren\u0026rsquo;t a regular NumPy array. Pandas already does this in a few places for some blessed types (like Categorical); we\u0026rsquo;d like to open that up to anybody.\nA couple months ago, a client came to Anaconda with a problem: they have a bunch of IP Address data that they\u0026rsquo;d like to work with in pandas. They didn\u0026rsquo;t just want to make a NumPy array of IP addresses for a few reasons:\n","keywords":["pandas"],"articleBody":"This is a status update on some enhancements for pandas. The goal of the work is to store things that are sufficiently array-like in a pandas DataFrame, even if they aren’t a regular NumPy array. Pandas already does this in a few places for some blessed types (like Categorical); we’d like to open that up to anybody.\nA couple months ago, a client came to Anaconda with a problem: they have a bunch of IP Address data that they’d like to work with in pandas. They didn’t just want to make a NumPy array of IP addresses for a few reasons:\nIPv6 addresses are 128 bits, so they can’t use a specialized NumPy dtype. It would have to be an object array, which will be slow for their large datasets. IP Addresses have special structure. They’d like to use this structure for special methods like is_reserved. It’s much better to put the knowledge of types in the library, rather than relying on analysts to know that this column of objects or strings is actually this other special type. I wrote up a proposal to gauge interest from the community for adding an IP Address dtype to pandas. The general sentiment was that an IP addresses were too specialized for inclusion pandas (which matched my own feelings). But, the community was interested in allowing 3rd party libraries to define their own types and having pandas “do the right thing” when it encounters them.\nPandas Internals While not technically true, you could reasonably describe a DataFrame as a dictionary of NumPy arrays. There are a few complications that invalidate that caricature , but the one I want to focus on is pandas’ extension dtypes.\nPandas has extended NumPy’s type system in a few cases. For the most part, this involves tricking pandas.DataFrame and pandas.Series into thinking that the object passed to it is a single array, when in fact it’s multiple arrays, or an array plus a bit of extra metadata.\ndatetime64[ns] with a timezone. A regular numpy.datetime64[ns] array (which is really just an array of integers) plus some metadata for the timezone. Period: An array of integer ordinals and some metadata about the frequency. Categorical: two arrays: one with the unique set of categories and a second array of codes, the positions in categories. Interval: Two arrays, one for the left-hand endpoints and one for the right-hand endpoints. So our definition of a pandas.DataFrame is now “A dictionary of NumPy arrays, or one of pandas’ extension types.” Internal to pandas, we have checks for “is this thing an extension dtype? If so take this special path.” To the user, it looks like a Categorical is just a regular column, but internally, it’s a bit messier.\nAnyway, the upshot of my proposal was to make changes to pandas' internals to support 3rd-party objects going down that “is this an extension dtype” path.\nPandas’ Array Interface To support external libraries defining extension array types, we defined an interface.\nIn pandas-19268 we laid out exactly what pandas considers sufficiently “array-like” for an extension array type. When pandas comes across one of these array-like objects, it avoids the previous behavior of just storing the data in a NumPy array of objects. The interface includes things like\nWhat type of scalars do you hold? How do I convert you to a NumPy array? __getitem__ Most things should be pretty straightforward to implement. In the test suit, we have a 60-line implementation for storing decimal.Decimal objects in a Series.\nIt’s important to emphasize that pandas’ ExtensionArray is not another array implementation. It’s just an agreement between pandas and your library that your array-like object (which may be a NumPy array, many NumPy arrays, an Arrow array, a list, anything really) that satisfies the proper semantics for storage inside a Series or DataFrame.\nWith those changes, I’ve been able to prototype a small library (named… cyberpandas) for storing arrays of IP Addresses. It defines IPAddress, an array-like container for IP Addresses. For this blogpost, the only relevant implementation detail is that IP Addresses are stored as a NumPy structured array with two uint64 fields. So we’re making pandas treat this 2-D array as a single array, like how Interval works. Here’s a taste:\nAs a taste for what’s possible, here’s a preview of our IP Address library, cyberpandas.\nIn [1]: import cyberpandas In [2]: import pandas as pd In [3]: ips = cyberpandas.IPAddress([ ...: '0.0.0.0', ...: '192.168.1.1', ...: '2001:0db8:85a3:0000:0000:8a2e:0370:7334', ...: ]) In [4]: ips Out[4]: IPAddress(['0.0.0.0', '192.168.1.1', '2001:db8:85a3::8a2e:370:7334']) In [5]: ips.data Out[5]: array([( 0, 0), ( 0, 3232235777), (2306139570357600256, 151930230829876)], dtype=[('hi', '\u003eu8'), ('lo', '\u003eu8')]) ips satisfies pandas’ ExtensionArray interface, so it can be stored inside pandas’ containers.\nIn [6]: ser = pd.Series(ips) In [7]: ser Out[7]: 0 0.0.0.0 1 192.168.1.1 2 2001:db8:85a3::8a2e:370:7334 dtype: ip Note the dtype in that output. That’s a custom dtype (like category) defined outside pandas.\nWe register a custom accessor with pandas claiming the .ip namespace (just like pandas uses .str or .dt or .cat):\nIn [8]: ser.ip.isna Out[8]: 0 True 1 False 2 False dtype: bool In [9]: ser.ip.is_ipv6 Out[9]: 0 False 1 False 2 True dtype: bool I’m extremely interested in seeing what the community builds on top of this interface. Joris has already tested out the Cythonized geopandas extension, which stores a NumPy array of pointers to geometry objects, and things seem great. I could see someone (perhaps you, dear reader?) building a JSONArray array type for working with nested data. That combined with custom .json accessor, perhaps with a jq-like query language should make for a powerful combination.\nI’m also happy to have to say “Closed, out of scope; sorry.” less often. Now it can be “Closed, out of scope; do it outside of pandas.” :)\nOpen Source Success Story It’s worth taking a moment to realize that this was a great example of open source at its best.\nA company had a need for a tool. They didn’t have the expertise or desire to build and maintain it internally, so they approached Anaconda (a for-profit company with a great OSS tradition) to do it for them. A proposal was made and rejected by the pandas community. You can’t just “buy” features in pandas if it conflicts too strongly with the long-term goals for the project. A more general solution was found, with minimal changes to pandas itself, allowing anyone to do this type of extension outside of pandas. We built the cyberpandas, which to users will feel like a first-class array type in pandas. Thanks to the tireless reviews from the other pandas contributors, especially Jeff Reback, Joris van den Bossche, and Stephen Hoyer. Look forward to these changes in the next major pandas release.\n","wordCount":"1116","inLanguage":"en","datePublished":"2018-02-12T00:00:00Z","dateModified":"2018-02-12T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://tomaugspurger.net/posts/pandas-extension-arrays/"},"publisher":{"@type":"Organization","name":"Tom's Blog","logo":{"@type":"ImageObject","url":"https://tomaugspurger.net/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tomaugspurger.net/ accesskey=h title="Tom's Blog (Alt + H)">Tom's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://tomaugspurger.net/about/ title=About><span>About</span></a></li><li><a href=https://tomaugspurger.net/archives title=Archive><span>Archive</span></a></li><li><a href=https://tomaugspurger.net/index.xml title=RSS><span>RSS</span></a></li><li><a href=https://tomaugspurger.net/tags title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Extension Arrays for Pandas</h1><div class=post-meta><span title='2018-02-12 00:00:00 +0000 UTC'>February 12, 2018</span></div></header><div class=post-content><p>This is a status update on some enhancements for pandas. The goal of the work
is to store things that are sufficiently array-like in a pandas <code>DataFrame</code>,
even if they aren&rsquo;t a regular NumPy array. Pandas already does this in a few
places for some blessed types (like <code>Categorical</code>); we&rsquo;d like to open that up to
anybody.</p><p>A couple months ago, a client came to <a href=https://www.anaconda.com/>Anaconda</a> with a problem: they
have a bunch of IP Address data that they&rsquo;d like to work with in pandas. They
didn&rsquo;t just want to make a NumPy array of IP addresses for a few reasons:</p><ol><li>IPv6 addresses are 128 bits, so they can&rsquo;t use a specialized NumPy dtype. It
would have to be an <code>object</code> array, which will be slow for their large
datasets.</li><li>IP Addresses have special structure. They&rsquo;d like to use this structure for
special methods like <code>is_reserved</code>.</li><li>It&rsquo;s much better to put the knowledge of types in the library, rather than
relying on analysts to know that this column of objects or strings is
<em>actually</em> this other special type.</li></ol><p>I wrote up a <a href=https://github.com/pandas-dev/pandas/issues/18767>proposal</a> to gauge interest from the community for
adding an IP Address dtype to pandas. The general sentiment was that an IP
addresses were too specialized for inclusion pandas (which matched my own
feelings). But, the community was interested in allowing 3rd party libraries to
define their own types and having pandas &ldquo;do the right thing&rdquo; when it encounters
them.</p><h2 id=pandas-internals>Pandas Internals<a hidden class=anchor aria-hidden=true href=#pandas-internals>#</a></h2><p>While not technically true, you could reasonably describe a <code>DataFrame</code> as a
dictionary of NumPy arrays. There are a few complications that invalidate that
caricature , but the one I want to focus on is pandas&rsquo; <em>extension dtypes</em>.</p><p>Pandas has extended NumPy&rsquo;s type system in a few cases. For the most part, this
involves tricking <code>pandas.DataFrame</code> and <code>pandas.Series</code> into thinking that
the object passed to it is a single array, when in fact it&rsquo;s multiple arrays, or
an array plus a bit of extra metadata.</p><ol><li><code>datetime64[ns]</code> <em>with a timezone</em>. A regular <code>numpy.datetime64[ns]</code> array
(which is really just an array of integers) plus some metadata for the
timezone.</li><li><code>Period</code>: An array of integer ordinals and some metadata about the frequency.</li><li><code>Categorical</code>: two arrays: one with the unique set of <code>categories</code>
and a second array of <code>codes</code>, the positions in <code>categories</code>.</li><li><code>Interval</code>: Two arrays, one for the left-hand endpoints and one for the
right-hand endpoints.</li></ol><p>So our definition of a <code>pandas.DataFrame</code> is now &ldquo;A dictionary of NumPy arrays,
or one of pandas&rsquo; extension types.&rdquo; Internal to pandas, we have checks for &ldquo;is
this thing an extension dtype? If so take this special path.&rdquo; To the user, it
looks like a <code>Categorical</code> is just a regular column, but internally, it&rsquo;s a bit
messier.</p><p>Anyway, the upshot of my <a href=https://github.com/pandas-dev/pandas/issues/18767>proposal</a> was to make changes to pandas'
internals to support 3rd-party objects going down that &ldquo;is this an extension
dtype&rdquo; path.</p><h2 id=pandas-array-interface>Pandas&rsquo; Array Interface<a hidden class=anchor aria-hidden=true href=#pandas-array-interface>#</a></h2><p>To support external libraries defining extension array types, we defined an interface.</p><p>In <a href=https://github.com/pandas-dev/pandas/pull/19268>pandas-19268</a> we laid out exactly what pandas considers
sufficiently &ldquo;array-like&rdquo; for an extension array type. When pandas comes across
one of these array-like objects, it avoids the previous behavior of just storing
the data in a NumPy array of objects. The interface includes things like</p><ul><li>What type of scalars do you hold?</li><li>How do I convert you to a NumPy array?</li><li><code>__getitem__</code></li></ul><p>Most things should be pretty straightforward to implement. In the test suit, we
have a 60-line implementation for storing <code>decimal.Decimal</code> objects in a
<code>Series</code>.</p><p>It&rsquo;s important to emphasize that pandas&rsquo; <code>ExtensionArray</code> is <em>not</em> another array
implementation. It&rsquo;s just an agreement between pandas and your library that your
array-like object (which may be a NumPy array, many NumPy arrays, an Arrow
array, a list, anything really) that satisfies the proper semantics for storage
inside a <code>Series</code> or <code>DataFrame</code>.</p><p>With those changes, I&rsquo;ve been able to prototype a small library (named&mldr;
<a href=https://github.com/ContinuumIO/cyberpandas>cyberpandas</a>) for storing arrays of IP Addresses. It defines
<code>IPAddress</code>, an array-like container for IP Addresses. For this blogpost, the
only relevant implementation detail is that IP Addresses are stored as a NumPy
structured array with two uint64 fields. So we&rsquo;re making pandas treat this 2-D
array as a single array, like how <code>Interval</code> works. Here&rsquo;s a taste:</p><p>As a taste for what&rsquo;s possible, here&rsquo;s a preview of our IP Address library,
<code>cyberpandas</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>1</span>]: <span style=color:#f92672>import</span> cyberpandas
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>2</span>]: <span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>3</span>]: ips <span style=color:#f92672>=</span> cyberpandas<span style=color:#f92672>.</span>IPAddress([
</span></span><span style=display:flex><span>   <span style=color:#f92672>...</span>:     <span style=color:#e6db74>&#39;0.0.0.0&#39;</span>,
</span></span><span style=display:flex><span>   <span style=color:#f92672>...</span>:     <span style=color:#e6db74>&#39;192.168.1.1&#39;</span>,
</span></span><span style=display:flex><span>   <span style=color:#f92672>...</span>:     <span style=color:#e6db74>&#39;2001:0db8:85a3:0000:0000:8a2e:0370:7334&#39;</span>,
</span></span><span style=display:flex><span>   <span style=color:#f92672>...</span>: ])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>4</span>]: ips
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>4</span>]: IPAddress([<span style=color:#e6db74>&#39;0.0.0.0&#39;</span>, <span style=color:#e6db74>&#39;192.168.1.1&#39;</span>, <span style=color:#e6db74>&#39;2001:db8:85a3::8a2e:370:7334&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>5</span>]: ips<span style=color:#f92672>.</span>data
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>5</span>]:
</span></span><span style=display:flex><span>array([(                  <span style=color:#ae81ff>0</span>,               <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>       (                  <span style=color:#ae81ff>0</span>,      <span style=color:#ae81ff>3232235777</span>),
</span></span><span style=display:flex><span>       (<span style=color:#ae81ff>2306139570357600256</span>, <span style=color:#ae81ff>151930230829876</span>)],
</span></span><span style=display:flex><span>      dtype<span style=color:#f92672>=</span>[(<span style=color:#e6db74>&#39;hi&#39;</span>, <span style=color:#e6db74>&#39;&gt;u8&#39;</span>), (<span style=color:#e6db74>&#39;lo&#39;</span>, <span style=color:#e6db74>&#39;&gt;u8&#39;</span>)])
</span></span></code></pre></div><p><code>ips</code> satisfies pandas&rsquo; <code>ExtensionArray</code> interface, so it can be stored inside
pandas&rsquo; containers.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>6</span>]: ser <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>Series(ips)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>7</span>]: ser
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>7</span>]:
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>                         <span style=color:#ae81ff>0.0.0.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>                     <span style=color:#ae81ff>192.168.1.1</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>    <span style=color:#ae81ff>2001</span>:db8:<span style=color:#ae81ff>85</span>a3::<span style=color:#ae81ff>8</span>a2e:<span style=color:#ae81ff>370</span>:<span style=color:#ae81ff>7334</span>
</span></span><span style=display:flex><span>dtype: ip
</span></span></code></pre></div><p>Note the <code>dtype</code> in that output. That&rsquo;s a custom dtype (like <code>category</code>) defined
<em>outside</em> pandas.</p><p>We register a <a href=http://pandas-docs.github.io/pandas-docs-travis/developer.html#developer-register-accessors>custom accessor</a> with pandas claiming the <code>.ip</code>
namespace (just like pandas uses <code>.str</code> or <code>.dt</code> or <code>.cat</code>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>8</span>]: ser<span style=color:#f92672>.</span>ip<span style=color:#f92672>.</span>isna
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>8</span>]:
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>     <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>    <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>    <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>dtype: bool
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>9</span>]: ser<span style=color:#f92672>.</span>ip<span style=color:#f92672>.</span>is_ipv6
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>9</span>]:
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>    <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>    <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>     <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>dtype: bool
</span></span></code></pre></div><p>I&rsquo;m <em>extremely</em> interested in seeing what the community builds on top of this
interface. Joris has already tested out the <a href=geopandas>Cythonized geopandas</a>
extension, which stores a NumPy array of pointers to geometry objects, and
things seem great. I could see someone (perhaps you, dear reader?) building a
<code>JSONArray</code> array type for working with nested data. That combined with custom
<code>.json</code> accessor, perhaps with a <a href=https://stedolan.github.io/jq/><code>jq</code>-like</a> query language should make for
a powerful combination.</p><p>I&rsquo;m also happy to have to say &ldquo;Closed, out of scope; sorry.&rdquo; less often. Now it
can be &ldquo;Closed, out of scope; do it outside of pandas.&rdquo; :)</p><h2 id=open-source-success-story>Open Source Success Story<a hidden class=anchor aria-hidden=true href=#open-source-success-story>#</a></h2><p>It&rsquo;s worth taking a moment to realize that this was a great example of open
source at its best.</p><ol><li>A company had a need for a tool. They didn&rsquo;t have the expertise or desire to
build and maintain it internally, so they approached Anaconda (a for-profit
company with a great OSS tradition) to do it for them.</li><li>A proposal was made <em>and rejected</em> by the pandas community. You can&rsquo;t just
&ldquo;buy&rdquo; features in pandas if it conflicts too strongly with the long-term
goals for the project.</li><li>A more general solution was found, with minimal changes to pandas itself,
allowing anyone to do this type of extension outside of pandas.</li><li>We built the <a href=https://github.com/ContinuumIO/cyberpandas>cyberpandas</a>, which to users will feel like a
first-class array type in pandas.</li></ol><p>Thanks to the tireless reviews from the other pandas contributors, especially
Jeff Reback, Joris van den Bossche, and Stephen Hoyer. Look forward to these
changes in the next major pandas release.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://tomaugspurger.net/tags/pandas/>Pandas</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://tomaugspurger.net/>Tom's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><a rel=me href=https://mastodon.social/@TomAugspurger></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>