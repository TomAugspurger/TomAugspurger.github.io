<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Practical Pandas Part 2 - More Tidying, More Data, and Merging | Tom's Blog</title>

                <link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

                <link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">

      <link rel="canonical" href="http://tomaugspurger.github.io/posts/pp02.html">



    
        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    

    
    <meta name="author" content="Tom Augspurger">
        <meta property="og:site_name" content="Tom's Blog">
    <meta property="og:title" content="Practical Pandas Part 2 - More Tidying, More Data, and Merging">
    <meta property="og:url" content="http://tomaugspurger.github.io/posts/pp02.html">
    <meta property="og:description" content="This is Part 2 in the Practical Pandas Series, where I work through a data analysis problem from start to finish.
It's a misconception that we can cleanly separate the data analysis pipeline into a li">
    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2014-09-04T00:00:00-05:00">
           <meta property="article:tag" content="data science">
           <meta property="article:tag" content="pandas">
           <meta property="article:tag" content="practical pandas">
           <meta property="article:tag" content="python">

    
    

</head>
<body>
    <section class="social">
        <ul>
                    <li><a href="../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="../archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="../rss.xml" title="RSS"><i class="icon-rss"></i></a></li>

        </ul>
    </section>
    <section class="page-content">
        <div class="content" rel="main">
    <div class="post">
        <h1 class="p-name entry-title" itemprop="headline name">Practical Pandas Part 2 - More Tidying, More Data, and Merging</h1>

        <div class="meta">
            <div class="authordate">
                <time class="timeago" datetime="2014-09-04T00:00:00-05:00">2014-09-04 00:00</time>
            
                      |  
        <a href="pp02.ipynb" id="sourcelink">Source</a>

            </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="../categories/data-science.html" rel="tag">data science</a></li>
           <li><a class="tag p-category" href="../categories/pandas.html" rel="tag">pandas</a></li>
           <li><a class="tag p-category" href="../categories/practical-pandas.html" rel="tag">practical pandas</a></li>
           <li><a class="tag p-category" href="../categories/python.html" rel="tag">python</a></li>
        </ul>
        </div>

        </div>
        <div class="body">
            <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>This is Part 2 in the Practical Pandas Series, where I work through a data analysis problem from start to finish.</em></p>
<p>It's a misconception that we can cleanly separate the data analysis pipeline into a linear
sequence of steps from</p>
<ol>
<li>data acqusition</li>
<li>data tidying</li>
<li>exploratory analysis</li>
<li>model building</li>
<li>production</li>
</ol>
<p>As you work through a problem you'll realize, "I need this other bit of data", or "this would be easier if I stored the data this way", or more commonly "strange, that's not supposed to happen".</p>
<p>We'll follow up our <a href="http://tomaugspurger.github.io/blog/2014/08/26/practical-pandas-part-1-reading-the-data/">last post</a> by circling back to cleaning up our data set, and fetching some more data.
Here's a reminder of where we were.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s">'data/cycle_store.h5'</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s">'merged'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[1]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Ride Time</th>
      <th>Ride Time (secs)</th>
      <th>Stopped Time</th>
      <th>Stopped Time (secs)</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Elevation (feet)</th>
      <th>Distance (miles)</th>
      <th>Speed (mph)</th>
      <th>Pace</th>
      <th>Pace (secs)</th>
      <th>Average Speed (mph)</th>
      <th>Average Pace</th>
      <th>Average Pace (secs)</th>
      <th>Ascent (feet)</th>
      <th>Descent (feet)</th>
      <th>Calories</th>
      <th>ride_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2013-08-01 07:07:10</td>
      <td>2014-09-02 00:00:01</td>
      <td>  1.1</td>
      <td>2014-09-02</td>
      <td> 0</td>
      <td> 41.703753</td>
      <td>-91.609892</td>
      <td> 963</td>
      <td> 0.00</td>
      <td> 2.88</td>
      <td>2014-09-02 00:20:51</td>
      <td> 1251</td>
      <td> 0.00</td>
      <td>2014-09-02 00:00:00</td>
      <td>    0</td>
      <td> 0</td>
      <td>   0</td>
      <td> 0</td>
      <td> 0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2013-08-01 07:07:17</td>
      <td>2014-09-02 00:00:08</td>
      <td>  8.2</td>
      <td>2014-09-02</td>
      <td> 0</td>
      <td> 41.703825</td>
      <td>-91.609835</td>
      <td> 852</td>
      <td> 0.01</td>
      <td> 2.88</td>
      <td>2014-09-02 00:20:51</td>
      <td> 1251</td>
      <td> 2.56</td>
      <td>2014-09-02 00:23:27</td>
      <td> 1407</td>
      <td> 0</td>
      <td> 129</td>
      <td> 0</td>
      <td> 0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2013-08-01 07:07:22</td>
      <td>2014-09-02 00:00:13</td>
      <td> 13.2</td>
      <td>2014-09-02</td>
      <td> 0</td>
      <td> 41.703858</td>
      <td>-91.609814</td>
      <td> 789</td>
      <td> 0.01</td>
      <td> 2.88</td>
      <td>2014-09-02 00:20:51</td>
      <td> 1251</td>
      <td> 2.27</td>
      <td>2014-09-02 00:26:27</td>
      <td> 1587</td>
      <td> 0</td>
      <td> 173</td>
      <td> 0</td>
      <td> 0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2013-08-01 07:07:27</td>
      <td>2014-09-02 00:00:18</td>
      <td> 18.2</td>
      <td>2014-09-02</td>
      <td> 0</td>
      <td> 41.703943</td>
      <td>-91.610090</td>
      <td> 787</td>
      <td> 0.02</td>
      <td> 6.60</td>
      <td>2014-09-02 00:09:06</td>
      <td>  546</td>
      <td> 4.70</td>
      <td>2014-09-02 00:12:47</td>
      <td>  767</td>
      <td> 0</td>
      <td> 173</td>
      <td> 1</td>
      <td> 0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2013-08-01 07:07:40</td>
      <td>2014-09-02 00:00:31</td>
      <td> 31.2</td>
      <td>2014-09-02</td>
      <td> 0</td>
      <td> 41.704381</td>
      <td>-91.610258</td>
      <td> 788</td>
      <td> 0.06</td>
      <td> 9.50</td>
      <td>2014-09-02 00:06:19</td>
      <td>  379</td>
      <td> 6.37</td>
      <td>2014-09-02 00:09:26</td>
      <td>  566</td>
      <td> 0</td>
      <td> 173</td>
      <td> 2</td>
      <td> 0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because of a <a href="https://github.com/pydata/pandas/issues/8189">bug</a> in pandas, we lost our timzone information when we filled in our missing values. Until that's fixed we'll have to manually add back the timezone info and convert.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I like to keep my DataFrame columns as valid python identifiers.
Let's define a helper function to rename the columns. We also have a few redundant columns that we can drop.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'Ride Time'</span><span class="p">,</span> <span class="s">'Stopped Time'</span><span class="p">,</span> <span class="s">'Pace'</span><span class="p">,</span> <span class="s">'Average Pace'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">renamer</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'('</span><span class="p">,</span> <span class="s">')'</span><span class="p">]:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">' '</span><span class="p">,</span> <span class="s">'_'</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">name</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">renamer</span><span class="p">)</span>
<span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[2]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['time',
 'ride_time_secs',
 'stopped_time_secs',
 'latitude',
 'longitude',
 'elevation_feet',
 'distance_miles',
 'speed_mph',
 'pace_secs',
 'average_speed_mph',
 'average_pace_secs',
 'ascent_feet',
 'descent_feet',
 'calories',
 'ride_id']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Do-you-trust-the-data?">Do you trust the data?<a class="anchor-link" href="pp02.html#Do-you-trust-the-data?">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Remember that I needed to manually start and stop the timer each ride, which natuarlly means that I messed this up at least once. Let's see if we can figure out the rides where I messed things up.
The first heuristic we'll use is checking to see if I moved at all.</p>
<p>All of my rides should have take roughly the same about of time. Let's get an idea of how the distribution of ride times look. We'll look at both the ride time and the time I spent stopped.
If I spend a long time in the same place, there's a good chance that I finished my ride and forgot to stop the timer.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">time_pal</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">n_colors</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c"># Plot it in mintues</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c"># max to get the last observation per ride since we know these are increasing</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'ride_id'</span><span class="p">)[[</span><span class="s">'stopped_time_secs'</span><span class="p">,</span> <span class="s">'ride_time_secs'</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">times</span><span class="p">[</span><span class="s">'ride_time_secs'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">time_pal</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Ride Time"</span><span class="p">)</span>

<span class="n">times</span><span class="p">[</span><span class="s">'stopped_time_secs'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">time_pal</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Stopped Time"</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[3]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.text.Text at 0x11531f3c8&gt;</pre>
</div>

</div>

<div class="output_area">
<div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's dig into that spike in the stopped time. We'll get it's ride id with the <code>Series.argmax</code> method.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">idx</span> <span class="o">=</span> <span class="n">times</span><span class="o">.</span><span class="n">stopped_time_secs</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
<span class="n">long_stop</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">ride_id</span> <span class="o">==</span> <span class="n">idx</span><span class="p">]</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">long_stop</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'time'</span><span class="p">)[</span><span class="s">'distance_miles'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">avg_distance</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'ride_id'</span><span class="p">)</span><span class="o">.</span><span class="n">distance_miles</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">"Distance (miles)"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">avg_distance</span><span class="p">,</span> <span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[4]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.LineCollection at 0x115004160&gt;</pre>
</div>

</div>

<div class="output_area">
<div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So it looks like I started my timer, sat around for about 15 minutes, and then continued with my normal ride (I verified that by plotting the average distance travelled per ride, and it was right on target).</p>
<p>We can use most of the columns fine, it's just the the <code>time</code> column we need to be careful with. Let's
make an adjusted time column <code>time_adj</code> that accounts for the stopped time.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">datetime</span>

<span class="k">def</span> <span class="nf">as_timedelta</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span> <span class="o">//</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s">'time_adj'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">time</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">stopped_time_secs</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">as_timedelta</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[5]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>ride_time_secs</th>
      <th>stopped_time_secs</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>elevation_feet</th>
      <th>distance_miles</th>
      <th>speed_mph</th>
      <th>pace_secs</th>
      <th>average_speed_mph</th>
      <th>average_pace_secs</th>
      <th>ascent_feet</th>
      <th>descent_feet</th>
      <th>calories</th>
      <th>ride_id</th>
      <th>time_adj</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2013-08-01 07:07:10</td>
      <td>  1.1</td>
      <td> 0</td>
      <td> 41.703753</td>
      <td>-91.609892</td>
      <td> 963</td>
      <td> 0.00</td>
      <td> 2.88</td>
      <td> 1251</td>
      <td> 0.00</td>
      <td>    0</td>
      <td> 0</td>
      <td>   0</td>
      <td> 0</td>
      <td> 0</td>
      <td>2013-08-01 07:07:10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2013-08-01 07:07:17</td>
      <td>  8.2</td>
      <td> 0</td>
      <td> 41.703825</td>
      <td>-91.609835</td>
      <td> 852</td>
      <td> 0.01</td>
      <td> 2.88</td>
      <td> 1251</td>
      <td> 2.56</td>
      <td> 1407</td>
      <td> 0</td>
      <td> 129</td>
      <td> 0</td>
      <td> 0</td>
      <td>2013-08-01 07:07:17</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2013-08-01 07:07:22</td>
      <td> 13.2</td>
      <td> 0</td>
      <td> 41.703858</td>
      <td>-91.609814</td>
      <td> 789</td>
      <td> 0.01</td>
      <td> 2.88</td>
      <td> 1251</td>
      <td> 2.27</td>
      <td> 1587</td>
      <td> 0</td>
      <td> 173</td>
      <td> 0</td>
      <td> 0</td>
      <td>2013-08-01 07:07:22</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2013-08-01 07:07:27</td>
      <td> 18.2</td>
      <td> 0</td>
      <td> 41.703943</td>
      <td>-91.610090</td>
      <td> 787</td>
      <td> 0.02</td>
      <td> 6.60</td>
      <td>  546</td>
      <td> 4.70</td>
      <td>  767</td>
      <td> 0</td>
      <td> 173</td>
      <td> 1</td>
      <td> 0</td>
      <td>2013-08-01 07:07:27</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2013-08-01 07:07:40</td>
      <td> 31.2</td>
      <td> 0</td>
      <td> 41.704381</td>
      <td>-91.610258</td>
      <td> 788</td>
      <td> 0.06</td>
      <td> 9.50</td>
      <td>  379</td>
      <td> 6.37</td>
      <td>  566</td>
      <td> 0</td>
      <td> 173</td>
      <td> 2</td>
      <td> 0</td>
      <td>2013-08-01 07:07:40</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When we start using the actual GPS data, we may need to do some smoothing.
These are just readings from my iPhone, which probably aren't that accurate. <a href="http://en.wikipedia.org/wiki/Kalman_filter">Kalman filters</a>, which I learned about in my econometrics class, are commonly used for this purpose.
But I think that's good enough for now.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Getting-More-Data">Getting More Data<a class="anchor-link" href="pp02.html#Getting-More-Data">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I'm interested in explaining the variation in how long it took me to make the ride.
I hypothesize that the weather may have had something to do with it. We'll fetch data from <a href="http://forecast.io">forecas.io</a> using their <a href="https://developer.forecast.io">API</a> to get the weather conditions at the time of each ride.</p>
<p>I looked at the <a href="https://developer.forecast.io/docs/v2">forecast.io documentation</a>, and noticed that the API will require a timezone. We could proceed in two ways</p>
<ol>
<li>Set <code>df.time</code> to be the index (a DatetimeIndex). Then localize with <code>df.tz_localize</code>
</li>
<li>Pass <code>df.time</code> through the DatetimeIndex constructor to set the timezone, and set that to be a column in df.</li>
</ol>
<p>Ideally we'd go with 1. Pandas has a lot of great additoinal functionality to offer when you have a DatetimeIndex (such as <code>resample</code>).
However, this conflicts with the desire to have a unique index with this specific dataset. The times recorded are at the second frequency, but there are occasionally multiple readings in a second.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># should be 0 if there are no repeats.</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>114</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So we'll go with #2, running the <code>time</code> column through the <code>DatetimeIndex</code> constructor, which has a <code>tz</code> (timezone) parameter, and placing that in a 'time' column. I'm in the <code>US/Central</code> timezone.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">df</span><span class="p">[</span><span class="s">'time'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="s">'US/Central'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[7]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>ride_time_secs</th>
      <th>stopped_time_secs</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>elevation_feet</th>
      <th>distance_miles</th>
      <th>speed_mph</th>
      <th>pace_secs</th>
      <th>average_speed_mph</th>
      <th>average_pace_secs</th>
      <th>ascent_feet</th>
      <th>descent_feet</th>
      <th>calories</th>
      <th>ride_id</th>
      <th>time_adj</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 2013-08-01 07:07:10-05:00</td>
      <td>  1.1</td>
      <td> 0</td>
      <td> 41.703753</td>
      <td>-91.609892</td>
      <td> 963</td>
      <td> 0.00</td>
      <td> 2.88</td>
      <td> 1251</td>
      <td> 0.00</td>
      <td>    0</td>
      <td> 0</td>
      <td>   0</td>
      <td> 0</td>
      <td> 0</td>
      <td>2013-08-01 07:07:10</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 2013-08-01 07:07:17-05:00</td>
      <td>  8.2</td>
      <td> 0</td>
      <td> 41.703825</td>
      <td>-91.609835</td>
      <td> 852</td>
      <td> 0.01</td>
      <td> 2.88</td>
      <td> 1251</td>
      <td> 2.56</td>
      <td> 1407</td>
      <td> 0</td>
      <td> 129</td>
      <td> 0</td>
      <td> 0</td>
      <td>2013-08-01 07:07:17</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 2013-08-01 07:07:22-05:00</td>
      <td> 13.2</td>
      <td> 0</td>
      <td> 41.703858</td>
      <td>-91.609814</td>
      <td> 789</td>
      <td> 0.01</td>
      <td> 2.88</td>
      <td> 1251</td>
      <td> 2.27</td>
      <td> 1587</td>
      <td> 0</td>
      <td> 173</td>
      <td> 0</td>
      <td> 0</td>
      <td>2013-08-01 07:07:22</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 2013-08-01 07:07:27-05:00</td>
      <td> 18.2</td>
      <td> 0</td>
      <td> 41.703943</td>
      <td>-91.610090</td>
      <td> 787</td>
      <td> 0.02</td>
      <td> 6.60</td>
      <td>  546</td>
      <td> 4.70</td>
      <td>  767</td>
      <td> 0</td>
      <td> 173</td>
      <td> 1</td>
      <td> 0</td>
      <td>2013-08-01 07:07:27</td>
    </tr>
    <tr>
      <th>4</th>
      <td> 2013-08-01 07:07:40-05:00</td>
      <td> 31.2</td>
      <td> 0</td>
      <td> 41.704381</td>
      <td>-91.610258</td>
      <td> 788</td>
      <td> 0.06</td>
      <td> 9.50</td>
      <td>  379</td>
      <td> 6.37</td>
      <td>  566</td>
      <td> 0</td>
      <td> 173</td>
      <td> 2</td>
      <td> 0</td>
      <td>2013-08-01 07:07:40</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There's nothing specific to pandas here, but knowing the basics of calling an API and parsing the response is still useful.
We'll use <a href="http://docs.python-requests.org/en/latest/">requests</a> to make the
API call. You'll need to register for you own API key. I keep mine in a JSON file in my Dropbox bin folder.</p>
<p>For this specific call we need to give the Latitude, Longitude, and Time that we want the weather for.
We fill in those to a url with the format <code>https://api.forecast.io/forecast/{key}/{Latitude},{Longitude},{Time}</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'/Users/tom/Dropbox/bin/api-keys.txt'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="s">'forecast.io'</span><span class="p">]</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.forecast.io/forecast/{key}/{Latitude},{Longitude},{Time}"</span>

<span class="n">vals</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="s">'latitude'</span><span class="p">,</span> <span class="s">'longitude'</span><span class="p">,</span> <span class="s">'time'</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">title</span><span class="p">())</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">vals</span><span class="p">[</span><span class="s">'Time'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="s">'Time'</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">' '</span><span class="p">,</span> <span class="s">'T'</span><span class="p">)</span>
<span class="n">vals</span><span class="p">[</span><span class="s">'key'</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">vals</span><span class="p">))</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">resp</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[9]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>dict_keys(['timezone', 'longitude', 'hourly', 'offset', 'currently', 'daily', 'latitude', 'flags'])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's the plan. For each ride, we'll get the current conditions at the time, latitude, and longitude of departure.
We'll use those values for the entirety of that ride.</p>
<p>I'm a bit concerned about the variance of some quantities from the weather data (like the windspeed and bearing). This would be something to look into for a serious analysis. If the quantities are highly variable you would want to take a rolling average over more datapoints. <code>forecast.io</code> limits you to 1,000 API calls per day though (at the free tier), so we'll just stick with one request per ride.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="k">def</span> <span class="nf">get_weather</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">ride_id</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Get the current weather conditions for for a ride at the time of departure.</span>
<span class="sd">    """</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.forecast.io/forecast/{key}/{Latitude},{Longitude},{Time}"</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s">"ride_id == @ride_id"</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][[</span><span class="s">'latitude'</span><span class="p">,</span>
               <span class="s">'longitude'</span><span class="p">,</span> <span class="s">'time'</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">title</span><span class="p">())</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="n">vals</span><span class="p">[</span><span class="s">'key'</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
    <span class="n">vals</span><span class="p">[</span><span class="s">'Time'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="s">'Time'</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">' '</span><span class="p">,</span> <span class="s">'T'</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">vals</span><span class="p">))</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'currently'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">resp</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's test it out:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">get_weather</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">ride_id</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">key</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[ ]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>{'apparentTemperature': 61.62,
 'precipProbability': 0,
 'summary': 'Clear',
 'cloudCover': 0,
 'windSpeed': 2.77,
 'windBearing': 282,
 'dewPoint': 58.66,
 'pressure': 1017.62,
 'icon': 'clear-day',
 'humidity': 0.9,
 'visibility': 8.89,
 'time': 1375358830,
 'temperature': 61.62,
 'precipIntensity': 0}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now do that for each <code>ride_id</code>, and store the result in a DataFrame</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_weather</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">ride_id</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">ride_id</span>
              <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">ride_id</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span>
<span class="n">weather</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
<span class="n">weather</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's fixup the dtype on the <code>time</code> column. We need to convert from the seconds to a datetime.
Then handle the timezone like before. This is returned in 'UTC', so we'll bring it back to
my local time with <code>.tz_convert</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">weather</span><span class="p">[</span><span class="s">'time'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">weather</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s">'s'</span><span class="p">),</span> <span class="n">tz</span><span class="o">=</span><span class="s">'UTC'</span><span class="p">)</span><span class="o">.</span>\
                     <span class="n">tz_convert</span><span class="p">(</span><span class="s">'US/Central'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can merge the two DataFrames <code>weather</code> and <code>df</code>. In this case it's quite simple since the share a single column, <code>time</code>. Pandas behaves exactly as you'd expect, merging on the provided column.
We take the <code>outer</code> join since we only have weather information for the first obervation of each ride.
We'll fill those values forward for the entirety of the ride.</p>
<p>I don't just call <code>with_weather.fillna()</code> since the non-weather columns have <code>NaN</code>s that we may want to treat separately.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">with_weather</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">weather</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">'time'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'outer'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">with_weather</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">with_weather</span><span class="p">[</span><span class="n">weather</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">with_weather</span><span class="p">[</span><span class="n">weather</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'ffill'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">with_weather</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">with_weather</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">with_weather</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With that done, let's write <code>with_weather</code> out to disk. We'll get a Performance Warning since some of the columns are text, which are relatively slow for HDF5, but it's not a problem worht worrying about for a dataset this small.
If you needed you could encode the text ones as integers with <code>pd.factorize</code>, write the integers out the the HDF5 store, and store the mapping from integer to text description elsewhere.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">with_weather</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s">'data/cycle_store.h5'</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s">'with_weather'</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="k">False</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">'table'</span><span class="p">)</span>
<span class="n">weather</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s">'data/cycle_store.h5'</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s">'weather'</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="k">False</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">'table'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="A-bit-of-Exploring">A bit of Exploring<a class="anchor-link" href="pp02.html#A-bit-of-Exploring">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've done a lot of data wrangling with a notable lack of pretty pictures to look at. Let's fix that.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">sns</span><span class="o">.</span><span class="n">puppyplot</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For some other (less) pretty pictures, let's visualize some of the weather data we collected.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s">"white"</span><span class="p">)</span>

<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s">'temperature'</span><span class="p">,</span> <span class="s">'apparentTemperature'</span><span class="p">,</span> <span class="s">'humidity'</span><span class="p">,</span> <span class="s">'dewPoint'</span><span class="p">,</span> <span class="s">'pressure'</span><span class="p">]</span>
<span class="c"># 'pressure', 'windBearing', 'windSpeed']].reset_index(drop=True))</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">weather</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="n">cols</span><span class="p">])</span>
                          
<span class="n">g</span><span class="o">.</span><span class="n">map_diag</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">"Blues_d"</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">map_upper</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Not bad! <a href="http://web.stanford.edu/~mwaskom/software/seaborn/">Seaborn</a> makes exploring these relationships very easy.</p>
<p>Let's also take a look at the wind data. I'm not a metorologist, but I saw a plot one time that's like a histogram for wind directions, but plotted on a <a href="http://en.wikipedia.org/wiki/Polar_coordinate_system">polar axis</a> (brings back memories of Calc II). Fortunately for us, matplotlib handles polar plots pretty easily, we just have to setup the
axes and hand it the values as radians.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">polar</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_theta_zero_location</span><span class="p">(</span><span class="s">'N'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_theta_direction</span><span class="p">(</span><span class="s">'clockwise'</span><span class="p">)</span>

<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">weather</span><span class="o">.</span><span class="n">windBearing</span><span class="o">.</span><span class="n">dropna</span><span class="p">()),</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">bins</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Direction of Wind Origin"</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>windBearing</code> represent the direction the wind is coming <em>from</em> so the most common direction is from the S/SW. It may be clearer to flip that around to represent the wind direction; I'm not sure what's standard.</p>
<p>If we were feeling ambitious, we could try to color the wedges by the windspeed. Let's give it a shot!</p>
<p>We'll need to get the average wind speed in each of our <code>bins</code> from above. This is clearly a <code>groupby</code>, but what excatly is the grouper? This is where pandas <code>Catagorical</code> comes in handy. We'll <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.cut.html"><code>pd.cut</code></a> the wind direction, and group the wind data by that.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">wind</span> <span class="o">=</span> <span class="n">weather</span><span class="p">[[</span><span class="s">'windSpeed'</span><span class="p">,</span> <span class="s">'windBearing'</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="n">ct</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">wind</span><span class="o">.</span><span class="n">windBearing</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
<span class="n">speeds</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">ct</span><span class="p">)[</span><span class="s">'windSpeed'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">BuGn</span><span class="p">(</span><span class="n">speeds</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">speeds</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I map the speeds to colors with one of matplotlib's colormaps. It expects values in <code>[0, 1]</code>, so
we normalize the speeds by dividing by the maximum.</p>
<p><code>hist</code> doesn't take a cmap argument, and I couldn't get <code>color</code> to work, so we'll just plot it like before,
and then modify the color of the patches after the fact.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">polar</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_theta_zero_location</span><span class="p">(</span><span class="s">'N'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_theta_direction</span><span class="p">(</span><span class="s">'clockwise'</span><span class="p">)</span>

<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">weather</span><span class="o">.</span><span class="n">windBearing</span><span class="o">.</span><span class="n">dropna</span><span class="p">()),</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">bins</span><span class="p">))</span>

<span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Direction of Wind Origin"</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Colorbars are tricky in matplotlib (at least for me). So I'm going to leave it at darker is stronger wind.</p>
<p>That's all for now. Come back next time for some exploratory analysis, and if we're lucky, some maps!</p>

</div>
</div>
</div>
    </div>
  </div>

        </div>
                <ul class="pager">
            <li class="previous">
                <a href="pp01.html" rel="prev" title="Practical Pandas Part 1 - Reading the Data">Previous post</a>
            </li>
            <li class="next">
                <a href="practical_pandas_03.html" rel="next" title="Practical Pandas Part 3 - Exploratory Data Analysis">Next post</a>
            </li>
        </ul>

    </div>
                    <footer id="footer" role="contentinfo">
            <p>Contents © 2015         <a href="mailto:tom.w.augspurger@gmail.com">Tom Augspurger</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>

        </div>
    </section>
    
    
                <script src="../assets/js/all-nocdn.js" type="text/javascript"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


        <script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
