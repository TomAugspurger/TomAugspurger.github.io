<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Tidy Data in Action | Tom's Blog</title><meta name=keywords content="python,scripts,data science,pandas"><meta name=description content="Hadley Whickham wrote a famous paper (for a certain definition of famous) about the importance of tidy data when doing data analysis. I want to talk a bit about that, using an example from a StackOverflow post, with a solution using pandas. The principles of tidy data aren&rsquo;t language specific.
A tidy dataset must satisfy three criteria (page 4 in Whickham&rsquo;s paper):
Each variable forms a column. Each observation forms a row."><meta name=author content><link rel=canonical href=https://tomaugspurger.github.io/posts/tidy-data-in-action/><link crossorigin=anonymous href=/assets/css/stylesheet.67b4a5a78be69ca812d40e5543fbd83efd0b0cc5025c2505fd7758fd5d32ec2e.css integrity="sha256-Z7Slp4vmnKgS1A5VQ/vYPv0LDMUCXCUF/XdY/V0y7C4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://tomaugspurger.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tomaugspurger.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tomaugspurger.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tomaugspurger.github.io/apple-touch-icon.png><link rel=mask-icon href=https://tomaugspurger.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Tidy Data in Action"><meta property="og:description" content="Hadley Whickham wrote a famous paper (for a certain definition of famous) about the importance of tidy data when doing data analysis. I want to talk a bit about that, using an example from a StackOverflow post, with a solution using pandas. The principles of tidy data aren&rsquo;t language specific.
A tidy dataset must satisfy three criteria (page 4 in Whickham&rsquo;s paper):
Each variable forms a column. Each observation forms a row."><meta property="og:type" content="article"><meta property="og:url" content="https://tomaugspurger.github.io/posts/tidy-data-in-action/"><meta property="article:section" content="posts"><meta name=twitter:card content="summary"><meta name=twitter:title content="Tidy Data in Action"><meta name=twitter:description content="Hadley Whickham wrote a famous paper (for a certain definition of famous) about the importance of tidy data when doing data analysis. I want to talk a bit about that, using an example from a StackOverflow post, with a solution using pandas. The principles of tidy data aren&rsquo;t language specific.
A tidy dataset must satisfy three criteria (page 4 in Whickham&rsquo;s paper):
Each variable forms a column. Each observation forms a row."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://tomaugspurger.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Tidy Data in Action","item":"https://tomaugspurger.github.io/posts/tidy-data-in-action/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Tidy Data in Action","name":"Tidy Data in Action","description":"Hadley Whickham wrote a famous paper (for a certain definition of famous) about the importance of tidy data when doing data analysis. I want to talk a bit about that, using an example from a StackOverflow post, with a solution using pandas. The principles of tidy data aren\u0026rsquo;t language specific.\nA tidy dataset must satisfy three criteria (page 4 in Whickham\u0026rsquo;s paper):\nEach variable forms a column. Each observation forms a row.","keywords":["python","scripts","data science","pandas"],"articleBody":"Hadley Whickham wrote a famous paper (for a certain definition of famous) about the importance of tidy data when doing data analysis. I want to talk a bit about that, using an example from a StackOverflow post, with a solution using pandas. The principles of tidy data aren’t language specific.\nA tidy dataset must satisfy three criteria (page 4 in Whickham’s paper):\nEach variable forms a column. Each observation forms a row. Each type of observational unit forms a table. In this StackOverflow post, the asker had some data NBA games, and wanted to know the number of days since a team last played. Here’s the example data:\nimport datetime import pandas as pd df = pd.DataFrame({'HomeTeam': ['HOU', 'CHI', 'DAL', 'HOU'], 'AwayTeam' : ['CHI', 'DAL', 'CHI', 'DAL'], 'HomeGameNum': [1, 2, 2, 2], 'AwayGameNum' : [1, 1, 3, 3], 'Date' : [datetime.date(2014,3,11), datetime.date(2014,3,12), datetime.date(2014,3,14), datetime.date(2014,3,15)]}) df AwayGameNum AwayTeam Date HomeGameNum HomeTeam 0 1 CHI 2014-03-11 1 HOU 1 1 DAL 2014-03-12 2 CHI 2 3 CHI 2014-03-14 2 DAL 3 3 DAL 2014-03-15 2 HOU 4 rows × 5 columns\nI want to focus on the second of the three criteria: Each observation forms a row. Realize that the structure your dataset should take reflects the question you’re trying to answer. For the SO question, we want to answer “How many days has it been since this team’s last game?” Given this context what is an observation?\nWe’ll define an observation as a team playing on a day. Does the original dataset in df satisfy the criteria for tidy data? No, it doesn’t since each row contains 2 observations, one for the home team and one for the away team.\nLet’s tidy up the dataset.\nI repeat each row (once for each team) and drop the game numbers (I don’t need them for this example) Select just the new rows (the one with odd indicies, % is the modulo operator in python) Overwrite the value of Team for the new rows, keeping the existing value for the old rows rename the HomeTeam column to is_home and make it a boolen column (True when the team is home) s = df[['Date', 'HomeTeam', 'AwayTeam']].reindex_axis(df.index.repeat(2)).reset_index(drop=True) s = s.rename(columns={'AwayTeam': 'Team'}) new = s[(s.index % 2).astype(bool)] s.loc[new.index, 'Team'] = new.loc[:, 'HomeTeam'] s = s.rename(columns={'HomeTeam': 'is_home'}) s['is_home'] = s['Team'] == s['is_home'] s Date is_home Team 0 2014-03-11 False CHI 1 2014-03-11 True HOU 2 2014-03-12 False DAL 3 2014-03-12 True CHI 4 2014-03-14 False CHI 5 2014-03-14 True DAL 6 2014-03-15 False DAL 7 2014-03-15 True HOU 8 rows × 3 columns\nNow that we have a 1:1 correspondance between rows and observations, answering the question is simple.\nWe’ll just group by each team and find the difference between each consecutive Date for that team. Then subtract one day so that back to back games reflect 0 days of rest.\ns['rest'] = s.groupby('Team')['Date'].diff() - datetime.timedelta(1) s Date is_home Team rest 0 2014-03-11 False CHI NaT 1 2014-03-11 True HOU NaT 2 2014-03-12 False DAL NaT 3 2014-03-12 True CHI 0 days 4 2014-03-14 False CHI 1 days 5 2014-03-14 True DAL 1 days 6 2014-03-15 False DAL 0 days 7 2014-03-15 True HOU 3 days 8 rows × 4 columns\nI planned on comparing that one line solution to the code needed with the messy data. But honestly, I’m having trouble writing the messy data version. You don’t really have anything to group on, so you’d need to keep track of the row where you last saw this team (either in AwayTeam or HomeTeam). And then each row will have two answers, one for each team. It’s certainly possible to write the necessary code, but the fact that I’m struggling so much to write the messy version is pretty good evidence for the importance of tidy data.\n","wordCount":"630","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://tomaugspurger.github.io/posts/tidy-data-in-action/"},"publisher":{"@type":"Organization","name":"Tom's Blog","logo":{"@type":"ImageObject","url":"https://tomaugspurger.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tomaugspurger.github.io accesskey=h title="Tom's Blog (Alt + H)">Tom's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://tomaugspurger.github.io/about/ title=About><span>About</span></a></li><li><a href=https://tomaugspurger.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://tomaugspurger.github.io/index.xml title=RSS><span>RSS</span></a></li><li><a href=https://tomaugspurger.github.io/tags title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Tidy Data in Action</h1><div class=post-meta></div></header><div class=post-content><p><a href=http://had.co.nz>Hadley Whickham</a> wrote a famous paper (for a certain definition of famous) about the importance of <a href=http://vita.had.co.nz/papers/tidy-data.pdf>tidy data</a> when doing data analysis.
I want to talk a bit about that, using an example from a StackOverflow post, with a solution using <a href=http://pandas.pydata.org>pandas</a>. The principles of tidy data aren&rsquo;t language specific.</p><p>A tidy dataset must satisfy three criteria (page 4 in <a href=http://vita.had.co.nz/papers/tidy-data.pdf>Whickham&rsquo;s paper</a>):</p><ol><li>Each variable forms a column.</li><li>Each observation forms a row.</li><li>Each type of observational unit forms a table.</li></ol><p>In this <a href=http://stackoverflow.com/questions/22695680/python-pandas-timedelta-specific-rows>StackOverflow post</a>, the asker had some data NBA games, and wanted to know the number of days since a team last played. Here&rsquo;s the example data:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({<span style=color:#e6db74>&#39;HomeTeam&#39;</span>: [<span style=color:#e6db74>&#39;HOU&#39;</span>, <span style=color:#e6db74>&#39;CHI&#39;</span>, <span style=color:#e6db74>&#39;DAL&#39;</span>, <span style=color:#e6db74>&#39;HOU&#39;</span>],
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#39;AwayTeam&#39;</span> : [<span style=color:#e6db74>&#39;CHI&#39;</span>, <span style=color:#e6db74>&#39;DAL&#39;</span>, <span style=color:#e6db74>&#39;CHI&#39;</span>, <span style=color:#e6db74>&#39;DAL&#39;</span>],
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#39;HomeGameNum&#39;</span>: [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>],
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#39;AwayGameNum&#39;</span> : [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>],
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#39;Date&#39;</span> : [datetime<span style=color:#f92672>.</span>date(<span style=color:#ae81ff>2014</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>11</span>), datetime<span style=color:#f92672>.</span>date(<span style=color:#ae81ff>2014</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>12</span>),
</span></span><span style=display:flex><span>                             datetime<span style=color:#f92672>.</span>date(<span style=color:#ae81ff>2014</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>14</span>), datetime<span style=color:#f92672>.</span>date(<span style=color:#ae81ff>2014</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>15</span>)]})
</span></span><span style=display:flex><span>df
</span></span></code></pre></div><div style=max-height:1000px;max-width:1500px;overflow:auto><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>AwayGameNum</th><th>AwayTeam</th><th>Date</th><th>HomeGameNum</th><th>HomeTeam</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>CHI</td><td>2014-03-11</td><td>1</td><td>HOU</td></tr><tr><th>1</th><td>1</td><td>DAL</td><td>2014-03-12</td><td>2</td><td>CHI</td></tr><tr><th>2</th><td>3</td><td>CHI</td><td>2014-03-14</td><td>2</td><td>DAL</td></tr><tr><th>3</th><td>3</td><td>DAL</td><td>2014-03-15</td><td>2</td><td>HOU</td></tr></tbody></table><p>4 rows × 5 columns</p></div><p>I want to focus on the second of the three criteria: <em>Each observation forms a row.</em>
Realize that the structure your dataset should take reflects the question you&rsquo;re trying to answer.
For the SO question, we want to answer &ldquo;How many days has it been since this team&rsquo;s last game?&rdquo;
Given this context what is an observation?</p><hr><p>We&rsquo;ll define an observation as a team playing on a day.
Does the original dataset in <code>df</code> satisfy the criteria for tidy data?
No, it doesn&rsquo;t since each row contains <strong>2</strong> observations, one for the home team and one for the away team.</p><p>Let&rsquo;s tidy up the dataset.</p><ul><li>I repeat each row (once for each team) and drop the game numbers (I don&rsquo;t need them for this example)</li><li>Select just the new rows (the one with odd indicies, <code>%</code> is the <a href=http://en.wikipedia.org/wiki/Modulo_operation>modulo operator</a> in python)</li><li>Overwrite the value of <code>Team</code> for the new rows, keeping the existing value for the old rows</li><li>rename the <code>HomeTeam</code> column to <code>is_home</code> and make it a boolen column (True when the team is home)</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>s <span style=color:#f92672>=</span> df[[<span style=color:#e6db74>&#39;Date&#39;</span>, <span style=color:#e6db74>&#39;HomeTeam&#39;</span>, <span style=color:#e6db74>&#39;AwayTeam&#39;</span>]]<span style=color:#f92672>.</span>reindex_axis(df<span style=color:#f92672>.</span>index<span style=color:#f92672>.</span>repeat(<span style=color:#ae81ff>2</span>))<span style=color:#f92672>.</span>reset_index(drop<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>s <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>rename(columns<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;AwayTeam&#39;</span>: <span style=color:#e6db74>&#39;Team&#39;</span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>new <span style=color:#f92672>=</span> s[(s<span style=color:#f92672>.</span>index <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span>)<span style=color:#f92672>.</span>astype(bool)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>s<span style=color:#f92672>.</span>loc[new<span style=color:#f92672>.</span>index, <span style=color:#e6db74>&#39;Team&#39;</span>] <span style=color:#f92672>=</span> new<span style=color:#f92672>.</span>loc[:, <span style=color:#e6db74>&#39;HomeTeam&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>s <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>rename(columns<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;HomeTeam&#39;</span>: <span style=color:#e6db74>&#39;is_home&#39;</span>})
</span></span><span style=display:flex><span>s[<span style=color:#e6db74>&#39;is_home&#39;</span>] <span style=color:#f92672>=</span> s[<span style=color:#e6db74>&#39;Team&#39;</span>] <span style=color:#f92672>==</span> s[<span style=color:#e6db74>&#39;is_home&#39;</span>]
</span></span><span style=display:flex><span>s
</span></span></code></pre></div><div style=max-height:1000px;max-width:1500px;overflow:auto><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>Date</th><th>is_home</th><th>Team</th></tr></thead><tbody><tr><th>0</th><td>2014-03-11</td><td>False</td><td>CHI</td></tr><tr><th>1</th><td>2014-03-11</td><td>True</td><td>HOU</td></tr><tr><th>2</th><td>2014-03-12</td><td>False</td><td>DAL</td></tr><tr><th>3</th><td>2014-03-12</td><td>True</td><td>CHI</td></tr><tr><th>4</th><td>2014-03-14</td><td>False</td><td>CHI</td></tr><tr><th>5</th><td>2014-03-14</td><td>True</td><td>DAL</td></tr><tr><th>6</th><td>2014-03-15</td><td>False</td><td>DAL</td></tr><tr><th>7</th><td>2014-03-15</td><td>True</td><td>HOU</td></tr></tbody></table><p>8 rows × 3 columns</p></div><p>Now that we have a 1:1 correspondance between rows and observations, answering the question is simple.</p><p>We&rsquo;ll just group by each team and find the difference between each consecutive <code>Date</code> for that team.
Then subtract one day so that back to back games reflect 0 days of rest.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>s[<span style=color:#e6db74>&#39;rest&#39;</span>] <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Team&#39;</span>)[<span style=color:#e6db74>&#39;Date&#39;</span>]<span style=color:#f92672>.</span>diff() <span style=color:#f92672>-</span> datetime<span style=color:#f92672>.</span>timedelta(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>s
</span></span></code></pre></div><div style=max-height:1000px;max-width:1500px;overflow:auto><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>Date</th><th>is_home</th><th>Team</th><th>rest</th></tr></thead><tbody><tr><th>0</th><td>2014-03-11</td><td>False</td><td>CHI</td><td>NaT</td></tr><tr><th>1</th><td>2014-03-11</td><td>True</td><td>HOU</td><td>NaT</td></tr><tr><th>2</th><td>2014-03-12</td><td>False</td><td>DAL</td><td>NaT</td></tr><tr><th>3</th><td>2014-03-12</td><td>True</td><td>CHI</td><td>0 days</td></tr><tr><th>4</th><td>2014-03-14</td><td>False</td><td>CHI</td><td>1 days</td></tr><tr><th>5</th><td>2014-03-14</td><td>True</td><td>DAL</td><td>1 days</td></tr><tr><th>6</th><td>2014-03-15</td><td>False</td><td>DAL</td><td>0 days</td></tr><tr><th>7</th><td>2014-03-15</td><td>True</td><td>HOU</td><td>3 days</td></tr></tbody></table><p>8 rows × 4 columns</p></div><p>I planned on comparing that one line solution to the code needed with the messy data.
But honestly, I&rsquo;m having trouble writing the messy data version.
You don&rsquo;t really have anything to group on, so you&rsquo;d need to keep track of the row where you last saw this team (either in <code>AwayTeam</code> or <code>HomeTeam</code>).
And then each row will have two answers, one for each team.
It&rsquo;s certainly possible to write the necessary code, but the fact that I&rsquo;m struggling so much to write the messy version is pretty good evidence for the importance of tidy data.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://tomaugspurger.github.io/tags/python/>python</a></li><li><a href=https://tomaugspurger.github.io/tags/scripts/>scripts</a></li><li><a href=https://tomaugspurger.github.io/tags/data-science/>data science</a></li><li><a href=https://tomaugspurger.github.io/tags/pandas/>pandas</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://tomaugspurger.github.io>Tom's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><a rel=me href=https://mastodon.social/@TomAugspurger></a>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>