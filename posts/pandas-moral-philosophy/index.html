<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Moral Philosophy for pandas or: What is `.values`? | Tom's Blog</title>
<meta name=keywords content="pandas"><meta name=description content="The other day, I put up a Twitter poll asking a simple question: What&rsquo;s the type of series.values?
Pop Quiz! What are the possible results for the following:
>>> type(pandas.Series.values)
&mdash; Tom Augspurger (@TomAugspurger) August 6, 2018 I was a bit limited for space, so I&rsquo;ll expand on the options here. Choose as many as you want.
NumPy ndarray pandas Categorical (or all of the above) An Index or any of it&rsquo;s subclasses (DatetimeIndex, CategoricalIndex, RangeIndex, etc."><meta name=author content><link rel=canonical href=https://tomaugspurger.net/posts/pandas-moral-philosophy/><link crossorigin=anonymous href=/assets/css/stylesheet.ced21e6d3497ee93fed8f8b357448095840179bd510b5ea0e6013078712e6dd1.css integrity="sha256-ztIebTSX7pP+2PizV0SAlYQBeb1RC16g5gEweHEubdE=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://tomaugspurger.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tomaugspurger.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tomaugspurger.net/favicon-32x32.png><link rel=apple-touch-icon href=https://tomaugspurger.net/apple-touch-icon.png><link rel=mask-icon href=https://tomaugspurger.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Moral Philosophy for pandas or: What is `.values`?"><meta property="og:description" content="The other day, I put up a Twitter poll asking a simple question: What&rsquo;s the type of series.values?
Pop Quiz! What are the possible results for the following:
>>> type(pandas.Series.values)
&mdash; Tom Augspurger (@TomAugspurger) August 6, 2018 I was a bit limited for space, so I&rsquo;ll expand on the options here. Choose as many as you want.
NumPy ndarray pandas Categorical (or all of the above) An Index or any of it&rsquo;s subclasses (DatetimeIndex, CategoricalIndex, RangeIndex, etc."><meta property="og:type" content="article"><meta property="og:url" content="https://tomaugspurger.net/posts/pandas-moral-philosophy/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-08-14T00:00:00+00:00"><meta property="article:modified_time" content="2018-08-14T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Moral Philosophy for pandas or: What is `.values`?"><meta name=twitter:description content="The other day, I put up a Twitter poll asking a simple question: What&rsquo;s the type of series.values?
Pop Quiz! What are the possible results for the following:
>>> type(pandas.Series.values)
&mdash; Tom Augspurger (@TomAugspurger) August 6, 2018 I was a bit limited for space, so I&rsquo;ll expand on the options here. Choose as many as you want.
NumPy ndarray pandas Categorical (or all of the above) An Index or any of it&rsquo;s subclasses (DatetimeIndex, CategoricalIndex, RangeIndex, etc."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://tomaugspurger.net/posts/"},{"@type":"ListItem","position":3,"name":"Moral Philosophy for pandas or: What is `.values`?","item":"https://tomaugspurger.net/posts/pandas-moral-philosophy/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Moral Philosophy for pandas or: What is `.values`?","name":"Moral Philosophy for pandas or: What is \u0060.values\u0060?","description":"The other day, I put up a Twitter poll asking a simple question: What\u0026rsquo;s the type of series.values?\nPop Quiz! What are the possible results for the following:\n\u0026gt;\u0026gt;\u0026gt; type(pandas.Series.values)\n\u0026mdash; Tom Augspurger (@TomAugspurger) August 6, 2018 I was a bit limited for space, so I\u0026rsquo;ll expand on the options here. Choose as many as you want.\nNumPy ndarray pandas Categorical (or all of the above) An Index or any of it\u0026rsquo;s subclasses (DatetimeIndex, CategoricalIndex, RangeIndex, etc.","keywords":["pandas"],"articleBody":"The other day, I put up a Twitter poll asking a simple question: What’s the type of series.values?\nPop Quiz! What are the possible results for the following:\n\u003e\u003e\u003e type(pandas.Series.values)\n— Tom Augspurger (@TomAugspurger) August 6, 2018 I was a bit limited for space, so I’ll expand on the options here. Choose as many as you want.\nNumPy ndarray pandas Categorical (or all of the above) An Index or any of it’s subclasses (DatetimeIndex, CategoricalIndex, RangeIndex, etc.) (or all of the above) None or all of the above I was prompted to write this post because a.) this is an (unfortunately) confusing topic and b.) it’s undergoing a lot of change right now (and, c.) I had this awesome title in my head).\nThe Answer Unfortunately I kind of messed up the poll. Things are even more complex than I initially thought.\nAs best I can tell, the possible types for series.values are\nNumPy ndarray pandas Categorical pandas SparseArray (I forgot about this one in the poll) So going with the cop-out “best-available” answer, I would have said that 2 was the best answer in the poll. SparseArray is technically and ndarray subclass (for now), so technically 2 is correct, but that’s a few too many technicallys for me.\nThe Explanation So, that’s a bit of a mess. How’d we get here? Or, stepping back a bit, what even is an array? What’s a dataframe?\nNumPy arrays are N-dimensional and homogenous. Every element in the array has to have the same data type.\nPandas dataframes are 2-dimensional and heterogenous. Different columns can have different data types. But every element in a single column (Series) has the same data type. I like to think of DataFrames as containers for Series. Stepping down a dimension, I think of Series as containers for 1-D arrays. In an ideal world, we could say Series are containers for NumPy ararys, but that’s not quite the case.\nWhile there’s a lot of overlap between the pandas and NumPy communites, there are still differences. Pandas users place different value on different features, so pandas has restricted and extended NumPy’s type system in a few directions. For example, early Pandas users (many of them in the financial sector) needed datetimes with timezones, but didn’t really care about lower-precision timestamps like datetime64[D]. So pandas limited its scope to just nanosecond-precision datetimes (datetime64[ns]) and extended it with some metedata for the timezone. Likewise for Categorical, period, sparse, interval, etc.\nSo back to Series.values; pandas had a choice: should Series.values always be a NumPy array, even if it means losing information like the timezone or categories, and even if it’s slow or could exhaust your memory (large categorical or sparse arrays)? Or should it faithfully represent the data, even if that means not returning an ndarray?\nI don’t think there’s a clear answer to this question. Both options have their downsides. In the end, we ended up with a messy compromise, where some things return ndarrays, some things return something else (Categorical), and some things do a bit of conversion before returning an ndarary.\nFor example, off the top of your head, do you know what the type of Series.values is for timezone-aware data?\nIn [2]: pd.Series(pd.date_range('2017', periods=4, tz='US/Eastern')) Out[2]: 0 2017-01-01 00:00:00-05:00 1 2017-01-02 00:00:00-05:00 2 2017-01-03 00:00:00-05:00 3 2017-01-04 00:00:00-05:00 dtype: datetime64[ns, US/Eastern] In [3]: pd.Series(pd.date_range('2017', periods=4, tz='US/Eastern')).values Out[3]: array(['2017-01-01T05:00:00.000000000', '2017-01-02T05:00:00.000000000', '2017-01-03T05:00:00.000000000', '2017-01-04T05:00:00.000000000'], dtype='datetime64[ns]') With the wisdom of Solomon, we decided to have it both ways; the values are converted to UTC and the timezone is dropped. I don’t think anyone would claim this is ideal, but it was backwards compatibile-ish. Given the constraints, it wasn’t the worst choice in the world.\nThe Near Future In pandas 0.24, we’ll (hopefully) have a good answer for what series.values is: a NumPy array or an ExtensionArray. For regular data types represented by NumPy, you’ll get an ndarray. For extension types (implemented in pandas or elsewhere) you’ll get an ExtensionArray. If you’re using Series.values, you can rely on the set of methods common to each.\nBut that raises the question: why are you using .values in the first place? There are some legitmate use cases (disabling automatic alignment, for example), but for many things, passing a Series will hopefully work as well as a NumPy array. To users of pandas, I recommend avoiding .values as much as possible. If you know that you need an ndarray, you’re probably best of using np.asarray(series). That will do the right thing for any data type.\nThe Far Future I’m hopeful that some day all we’ll have a common language for these data types. There’s a lot going on in the numeric Python ecosystem right now. Stay tuned!\n","wordCount":"782","inLanguage":"en","datePublished":"2018-08-14T00:00:00Z","dateModified":"2018-08-14T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://tomaugspurger.net/posts/pandas-moral-philosophy/"},"publisher":{"@type":"Organization","name":"Tom's Blog","logo":{"@type":"ImageObject","url":"https://tomaugspurger.net/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tomaugspurger.net accesskey=h title="Tom's Blog (Alt + H)">Tom's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://tomaugspurger.net/about/ title=About><span>About</span></a></li><li><a href=https://tomaugspurger.net/archives title=Archive><span>Archive</span></a></li><li><a href=https://tomaugspurger.net/index.xml title=RSS><span>RSS</span></a></li><li><a href=https://tomaugspurger.net/tags title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Moral Philosophy for pandas or: What is `.values`?</h1><div class=post-meta><span title='2018-08-14 00:00:00 +0000 UTC'>August 14, 2018</span></div></header><div class=post-content><p>The other day, I put up a <a href=https://twitter.com/TomAugspurger/status/1026578613389455360>Twitter poll</a> asking a simple question: What&rsquo;s the type of <code>series.values</code>?</p><blockquote class=twitter-tweet data-lang=en><p lang=en dir=ltr>Pop Quiz! What are the possible results for the following:<br><br>>>> type(pandas.Series.values)</p>&mdash; Tom Augspurger (@TomAugspurger) <a href="https://twitter.com/TomAugspurger/status/1026578613389455360?ref_src=twsrc%5Etfw">August 6, 2018</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>I was a bit limited for space, so I&rsquo;ll expand on the options here. Choose as many as you want.</p><ol><li>NumPy ndarray</li><li>pandas Categorical (or all of the above)</li><li>An Index or any of it&rsquo;s subclasses (DatetimeIndex, CategoricalIndex, RangeIndex, etc.) (or all of the above)</li><li>None or all of the above</li></ol><p>I was prompted to write this post because <em>a.)</em> this is an (unfortunately) confusing topic and <em>b.)</em> it&rsquo;s undergoing a lot of change right now (and, <em>c.)</em> I had this awesome title in my head).</p><h2 id=the-answer>The Answer<a hidden class=anchor aria-hidden=true href=#the-answer>#</a></h2><p>Unfortunately I kind of messed up the poll. Things are even more complex than I initially thought.</p><p>As best I can tell, the possible types for <code>series.values</code> are</p><ul><li>NumPy ndarray</li><li>pandas Categorical</li><li>pandas SparseArray (I forgot about this one in the poll)</li></ul><p>So going with the cop-out &ldquo;best-available&rdquo; answer, I would have said that <em>2</em> was the best answer in the poll.
SparseArray is <em>technically</em> and ndarray subclass (for now), so <em>technically</em> 2 is correct, but that&rsquo;s a few too many <em>technically</em>s for me.</p><h2 id=the-explanation>The Explanation<a hidden class=anchor aria-hidden=true href=#the-explanation>#</a></h2><p>So, that&rsquo;s a bit of a mess. How&rsquo;d we get here? Or, stepping back a bit, what even is an array? What&rsquo;s a dataframe?</p><p>NumPy arrays are N-dimensional and <em>homogenous</em>. Every element in the array has to have the same data type.</p><p>Pandas dataframes are 2-dimensional and <em>heterogenous</em>. Different columns can have different data types. But every element in a single column (Series) has the same data type.
I like to think of DataFrames as containers for Series.
Stepping down a dimension, I think of Series as containers for 1-D arrays.
In an ideal world, we could say Series are containers for NumPy ararys, but that&rsquo;s not <em>quite</em> the case.</p><p>While there&rsquo;s a lot of overlap between the pandas and NumPy communites, there are still differences.
Pandas users place different value on different features, so pandas has restricted and <em>extended</em> NumPy&rsquo;s type system in a few directions.
For example, early Pandas users (many of them in the financial sector) needed datetimes with timezones, but didn&rsquo;t really care about lower-precision timestamps like <code>datetime64[D]</code>.
So pandas limited its scope to just nanosecond-precision datetimes (<code>datetime64[ns]</code>) and extended it with some metedata for the timezone.
Likewise for Categorical, period, sparse, interval, etc.</p><p>So back to <code>Series.values</code>; pandas had a choice: should <code>Series.values</code> always be a NumPy array, even if it means losing information like the timezone or categories, and even if it&rsquo;s slow or could exhaust your memory (large categorical or sparse arrays)?
Or should it faithfully represent the data, even if that means not returning an ndarray?</p><p>I don&rsquo;t think there&rsquo;s a clear answer to this question. Both options have their downsides.
In the end, we ended up with a messy compromise, where some things return ndarrays, some things return something else (Categorical), and some things do a bit of conversion before returning an <code>ndarary</code>.</p><p>For example, off the top of your head, do you know what the type of <code>Series.values</code> is for timezone-aware data?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>2</span>]: pd<span style=color:#f92672>.</span>Series(pd<span style=color:#f92672>.</span>date_range(<span style=color:#e6db74>&#39;2017&#39;</span>, periods<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>, tz<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;US/Eastern&#39;</span>))
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>2</span>]:
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>   <span style=color:#ae81ff>2017</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span>:<span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>   <span style=color:#ae81ff>2017</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>02</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span>:<span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>   <span style=color:#ae81ff>2017</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>03</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span>:<span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>   <span style=color:#ae81ff>2017</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span>:<span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span>dtype: datetime64[ns, US<span style=color:#f92672>/</span>Eastern]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>3</span>]: pd<span style=color:#f92672>.</span>Series(pd<span style=color:#f92672>.</span>date_range(<span style=color:#e6db74>&#39;2017&#39;</span>, periods<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>, tz<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;US/Eastern&#39;</span>))<span style=color:#f92672>.</span>values
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>3</span>]:
</span></span><span style=display:flex><span>array([<span style=color:#e6db74>&#39;2017-01-01T05:00:00.000000000&#39;</span>, <span style=color:#e6db74>&#39;2017-01-02T05:00:00.000000000&#39;</span>,
</span></span><span style=display:flex><span>       <span style=color:#e6db74>&#39;2017-01-03T05:00:00.000000000&#39;</span>, <span style=color:#e6db74>&#39;2017-01-04T05:00:00.000000000&#39;</span>],
</span></span><span style=display:flex><span>      dtype<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;datetime64[ns]&#39;</span>)
</span></span></code></pre></div><p>With the wisdom of Solomon, we decided to have it both ways; the values are converted to UTC and the timezone is dropped.
I don&rsquo;t think anyone would claim this is ideal, but it was backwards compatibile-ish.
Given the constraints, it wasn&rsquo;t the worst choice in the world.</p><h2 id=the-near-future>The Near Future<a hidden class=anchor aria-hidden=true href=#the-near-future>#</a></h2><p>In pandas 0.24, we&rsquo;ll (hopefully) have a good answer for what <code>series.values</code> is: a NumPy array or an <a href=http://pandas-docs.github.io/pandas-docs-travis/extending.html#extension-types>ExtensionArray</a>.
For regular data types represented by NumPy, you&rsquo;ll get an ndarray.
For extension types (implemented in pandas or elsewhere) you&rsquo;ll get an ExtensionArray.
If you&rsquo;re using <code>Series.values</code>, you can rely on the set of methods common to each.</p><p>But that raises the question: <em>why</em> are you using <code>.values</code> in the first place?
There are some legitmate use cases (disabling automatic alignment, for example),
but for many things, passing a <code>Series</code> will hopefully work as well as a NumPy array.
To users of pandas, I recommend avoiding <code>.values</code> as much as possible.
If you know that you need an ndarray, you&rsquo;re probably best of using <code>np.asarray(series)</code>.
That will do the right thing for any data type.</p><h2 id=the-far-future>The Far Future<a hidden class=anchor aria-hidden=true href=#the-far-future>#</a></h2><p>I&rsquo;m hopeful that some day all we&rsquo;ll have a common language for these data types.
There&rsquo;s a lot going on in the numeric Python ecosystem right now. Stay tuned!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://tomaugspurger.net/tags/pandas/>pandas</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://tomaugspurger.net>Tom's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><a rel=me href=https://mastodon.social/@TomAugspurger></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>