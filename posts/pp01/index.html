<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Practical Pandas Part 1 - Reading the Data | Tom's Blog</title><meta name=keywords content="python,data science,pandas"><meta name=description content="This is the first post in a series where I&rsquo;ll show how I use pandas on real-world datasets.
For this post, we&rsquo;ll look at data I collected with Cyclemeter on my daily bike ride to and from school last year. I had to manually start and stop the tracking at the beginning and end of each ride. There may have been times where I forgot to do that, so we&rsquo;ll see if we can find those."><meta name=author content><link rel=canonical href=https://tomaugspurger.github.io/posts/pp01/><link crossorigin=anonymous href=/assets/css/stylesheet.3690c96d8a707265a16abd3b389bb33e4e3916869c3142cba43a3cfaaed4b5f9.css integrity="sha256-NpDJbYpwcmWhar07OJuzPk45FoacMULLpDo8+q7Utfk=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://tomaugspurger.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tomaugspurger.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tomaugspurger.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tomaugspurger.github.io/apple-touch-icon.png><link rel=mask-icon href=https://tomaugspurger.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Practical Pandas Part 1 - Reading the Data"><meta property="og:description" content="This is the first post in a series where I&rsquo;ll show how I use pandas on real-world datasets.
For this post, we&rsquo;ll look at data I collected with Cyclemeter on my daily bike ride to and from school last year. I had to manually start and stop the tracking at the beginning and end of each ride. There may have been times where I forgot to do that, so we&rsquo;ll see if we can find those."><meta property="og:type" content="article"><meta property="og:url" content="https://tomaugspurger.github.io/posts/pp01/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-08-26T00:00:00+00:00"><meta property="article:modified_time" content="2014-08-26T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Practical Pandas Part 1 - Reading the Data"><meta name=twitter:description content="This is the first post in a series where I&rsquo;ll show how I use pandas on real-world datasets.
For this post, we&rsquo;ll look at data I collected with Cyclemeter on my daily bike ride to and from school last year. I had to manually start and stop the tracking at the beginning and end of each ride. There may have been times where I forgot to do that, so we&rsquo;ll see if we can find those."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://tomaugspurger.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Practical Pandas Part 1 - Reading the Data","item":"https://tomaugspurger.github.io/posts/pp01/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Practical Pandas Part 1 - Reading the Data","name":"Practical Pandas Part 1 - Reading the Data","description":"This is the first post in a series where I\u0026rsquo;ll show how I use pandas on real-world datasets.\nFor this post, we\u0026rsquo;ll look at data I collected with Cyclemeter on my daily bike ride to and from school last year. I had to manually start and stop the tracking at the beginning and end of each ride. There may have been times where I forgot to do that, so we\u0026rsquo;ll see if we can find those.","keywords":["python","data science","pandas"],"articleBody":"This is the first post in a series where I’ll show how I use pandas on real-world datasets.\nFor this post, we’ll look at data I collected with Cyclemeter on my daily bike ride to and from school last year. I had to manually start and stop the tracking at the beginning and end of each ride. There may have been times where I forgot to do that, so we’ll see if we can find those.\nLet’s begin in the usual fashion, a bunch of imports and loading our data.\nimport numpy as np import pandas as pd import seaborn as sns import matplotlib.pyplot as plt from IPython import display Each day has data recorded in two formats, CSVs and KMLs. For now I’ve just uploaded the CSVs to the data/ directory. We’ll start with the those, and come back to the KMLs later.\n!ls data | head -n 5 Cyclemeter-Cycle-20130801-0707.csv Cyclemeter-Cycle-20130801-0707.kml Cyclemeter-Cycle-20130801-1720.csv Cyclemeter-Cycle-20130801-1720.kml Cyclemeter-Cycle-20130805-0819.csv Take a look at the first one to see how the file’s laid out.\ndf = pd.read_csv('data/Cyclemeter-Cycle-20130801-0707.csv') df.head() Time Ride Time Ride Time (secs) Stopped Time Stopped Time (secs) Latitude Longitude Elevation (feet) Distance (miles) Speed (mph) Pace Pace (secs) Average Speed (mph) Average Pace Average Pace (secs) Ascent (feet) Descent (feet) Calories 0 2013-08-01 07:07:10 0:00:01 1.1 0:00:00 0 41.703753 -91.609892 963 0.00 2.88 0:20:51 1251 0.00 0:00:00 0 0 0 0 1 2013-08-01 07:07:17 0:00:08 8.2 0:00:00 0 41.703825 -91.609835 852 0.01 2.88 0:20:51 1251 2.56 0:23:27 1407 0 129 0 2 2013-08-01 07:07:22 0:00:13 13.2 0:00:00 0 41.703858 -91.609814 789 0.01 2.88 0:20:51 1251 2.27 0:26:27 1587 0 173 0 3 2013-08-01 07:07:27 0:00:18 18.2 0:00:00 0 41.703943 -91.610090 787 0.02 6.60 0:09:06 546 4.70 0:12:47 767 0 173 1 4 2013-08-01 07:07:40 0:00:31 31.2 0:00:00 0 41.704381 -91.610258 788 0.06 9.50 0:06:19 379 6.37 0:09:26 566 0 173 2 df.info() ","wordCount":"1255","inLanguage":"en","datePublished":"2014-08-26T00:00:00Z","dateModified":"2014-08-26T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://tomaugspurger.github.io/posts/pp01/"},"publisher":{"@type":"Organization","name":"Tom's Blog","logo":{"@type":"ImageObject","url":"https://tomaugspurger.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tomaugspurger.github.io accesskey=h title="Tom's Blog (Alt + H)">Tom's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://tomaugspurger.github.io/about/ title=About><span>About</span></a></li><li><a href=https://tomaugspurger.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://tomaugspurger.github.io/index.xml title=RSS><span>RSS</span></a></li><li><a href=https://tomaugspurger.github.io/tags title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Practical Pandas Part 1 - Reading the Data</h1><div class=post-meta><span title='2014-08-26 00:00:00 +0000 UTC'>August 26, 2014</span></div></header><div class=post-content><p>This is the first post in a series where I&rsquo;ll show how I use pandas on real-world datasets.</p><p>For this post, we&rsquo;ll look at data I collected with <a href=http://abvio.com/cyclemeter/>Cyclemeter</a> on
my daily bike ride to and from school last year.
I had to manually start and stop the tracking at the beginning and end of each ride. There may
have been times where I forgot to do that, so we&rsquo;ll see if we can find those.</p><p>Let&rsquo;s begin in the usual fashion, a bunch of imports and loading our data.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> seaborn <span style=color:#66d9ef>as</span> sns
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> IPython <span style=color:#f92672>import</span> display
</span></span></code></pre></div><p>Each day has data recorded in two formats, CSVs and <a href=https://developers.google.com/kml/>KMLs</a>.
For now I&rsquo;ve just uploaded the CSVs to the <a href=https://github.com/TomAugspurger/PracticalPandas/tree/master/data><code>data/</code></a> directory.
We&rsquo;ll start with the those, and come back to the KMLs later.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>!</span>ls data <span style=color:#f92672>|</span> head <span style=color:#f92672>-</span>n <span style=color:#ae81ff>5</span>
</span></span></code></pre></div><pre><code>Cyclemeter-Cycle-20130801-0707.csv
Cyclemeter-Cycle-20130801-0707.kml
Cyclemeter-Cycle-20130801-1720.csv
Cyclemeter-Cycle-20130801-1720.kml
Cyclemeter-Cycle-20130805-0819.csv
</code></pre><p>Take a look at the first one to see how the file&rsquo;s laid out.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#39;data/Cyclemeter-Cycle-20130801-0707.csv&#39;</span>)
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>head()
</span></span></code></pre></div><div style=max-height:1000px;max-width:1500px;overflow:auto><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>Time</th><th>Ride Time</th><th>Ride Time (secs)</th><th>Stopped Time</th><th>Stopped Time (secs)</th><th>Latitude</th><th>Longitude</th><th>Elevation (feet)</th><th>Distance (miles)</th><th>Speed (mph)</th><th>Pace</th><th>Pace (secs)</th><th>Average Speed (mph)</th><th>Average Pace</th><th>Average Pace (secs)</th><th>Ascent (feet)</th><th>Descent (feet)</th><th>Calories</th></tr></thead><tbody><tr><th>0</th><td>2013-08-01 07:07:10</td><td>0:00:01</td><td>1.1</td><td>0:00:00</td><td>0</td><td>41.703753</td><td>-91.609892</td><td>963</td><td>0.00</td><td>2.88</td><td>0:20:51</td><td>1251</td><td>0.00</td><td>0:00:00</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>1</th><td>2013-08-01 07:07:17</td><td>0:00:08</td><td>8.2</td><td>0:00:00</td><td>0</td><td>41.703825</td><td>-91.609835</td><td>852</td><td>0.01</td><td>2.88</td><td>0:20:51</td><td>1251</td><td>2.56</td><td>0:23:27</td><td>1407</td><td>0</td><td>129</td><td>0</td></tr><tr><th>2</th><td>2013-08-01 07:07:22</td><td>0:00:13</td><td>13.2</td><td>0:00:00</td><td>0</td><td>41.703858</td><td>-91.609814</td><td>789</td><td>0.01</td><td>2.88</td><td>0:20:51</td><td>1251</td><td>2.27</td><td>0:26:27</td><td>1587</td><td>0</td><td>173</td><td>0</td></tr><tr><th>3</th><td>2013-08-01 07:07:27</td><td>0:00:18</td><td>18.2</td><td>0:00:00</td><td>0</td><td>41.703943</td><td>-91.610090</td><td>787</td><td>0.02</td><td>6.60</td><td>0:09:06</td><td>546</td><td>4.70</td><td>0:12:47</td><td>767</td><td>0</td><td>173</td><td>1</td></tr><tr><th>4</th><td>2013-08-01 07:07:40</td><td>0:00:31</td><td>31.2</td><td>0:00:00</td><td>0</td><td>41.704381</td><td>-91.610258</td><td>788</td><td>0.06</td><td>9.50</td><td>0:06:19</td><td>379</td><td>6.37</td><td>0:09:26</td><td>566</td><td>0</td><td>173</td><td>2</td></tr></tbody></table></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df<span style=color:#f92672>.</span>info()
</span></span></code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 252 entries, 0 to 251
Data columns (total 18 columns):
Time                   252 non-null object
Ride Time              252 non-null object
Ride Time (secs)       252 non-null float64
Stopped Time           252 non-null object
Stopped Time (secs)    252 non-null float64
Latitude               252 non-null float64
Longitude              252 non-null float64
Elevation (feet)       252 non-null int64
Distance (miles)       252 non-null float64
Speed (mph)            252 non-null float64
Pace                   252 non-null object
Pace (secs)            252 non-null int64
Average Speed (mph)    252 non-null float64
Average Pace           252 non-null object
Average Pace (secs)    252 non-null int64
Ascent (feet)          252 non-null int64
Descent (feet)         252 non-null int64
Calories               252 non-null int64
dtypes: float64(7), int64(6), object(5)
</code></pre><p>Pandas has automatically parsed the headers, but it could use a bit of help on some dtypes.
We can see that the <code>Time</code> column is a <code>datetime</code> but it&rsquo;s been parsed as an <code>object</code> dtype.
This is pandas&rsquo; fallback dtype that can store anything, but its operations won&rsquo;t be optimized like
they would on an <code>float</code> or <code>bool</code> or <code>datetime[64]</code>. <code>read_csv</code> takes a <code>parse_dates</code> parameter, which
we&rsquo;ll give a list of column names.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>date_cols <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;Time&#34;</span>, <span style=color:#e6db74>&#34;Ride Time&#34;</span>, <span style=color:#e6db74>&#34;Stopped Time&#34;</span>, <span style=color:#e6db74>&#34;Pace&#34;</span>, <span style=color:#e6db74>&#34;Average Pace&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#34;data/Cyclemeter-Cycle-20130801-0707.csv&#34;</span>,
</span></span><span style=display:flex><span>                 parse_dates<span style=color:#f92672>=</span>date_cols)
</span></span><span style=display:flex><span>display<span style=color:#f92672>.</span>display_html(df<span style=color:#f92672>.</span>head())
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>info()
</span></span></code></pre></div><div style=max-height:1000px;max-width:1500px;overflow:auto><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>Time</th><th>Ride Time</th><th>Ride Time (secs)</th><th>Stopped Time</th><th>Stopped Time (secs)</th><th>Latitude</th><th>Longitude</th><th>Elevation (feet)</th><th>Distance (miles)</th><th>Speed (mph)</th><th>Pace</th><th>Pace (secs)</th><th>Average Speed (mph)</th><th>Average Pace</th><th>Average Pace (secs)</th><th>Ascent (feet)</th><th>Descent (feet)</th><th>Calories</th></tr></thead><tbody><tr><th>0</th><td>2013-08-01 07:07:10</td><td>2014-08-26 00:00:01</td><td>1.1</td><td>2014-08-26</td><td>0</td><td>41.703753</td><td>-91.609892</td><td>963</td><td>0.00</td><td>2.88</td><td>2014-08-26 00:20:51</td><td>1251</td><td>0.00</td><td>2014-08-26 00:00:00</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>1</th><td>2013-08-01 07:07:17</td><td>2014-08-26 00:00:08</td><td>8.2</td><td>2014-08-26</td><td>0</td><td>41.703825</td><td>-91.609835</td><td>852</td><td>0.01</td><td>2.88</td><td>2014-08-26 00:20:51</td><td>1251</td><td>2.56</td><td>2014-08-26 00:23:27</td><td>1407</td><td>0</td><td>129</td><td>0</td></tr><tr><th>2</th><td>2013-08-01 07:07:22</td><td>2014-08-26 00:00:13</td><td>13.2</td><td>2014-08-26</td><td>0</td><td>41.703858</td><td>-91.609814</td><td>789</td><td>0.01</td><td>2.88</td><td>2014-08-26 00:20:51</td><td>1251</td><td>2.27</td><td>2014-08-26 00:26:27</td><td>1587</td><td>0</td><td>173</td><td>0</td></tr><tr><th>3</th><td>2013-08-01 07:07:27</td><td>2014-08-26 00:00:18</td><td>18.2</td><td>2014-08-26</td><td>0</td><td>41.703943</td><td>-91.610090</td><td>787</td><td>0.02</td><td>6.60</td><td>2014-08-26 00:09:06</td><td>546</td><td>4.70</td><td>2014-08-26 00:12:47</td><td>767</td><td>0</td><td>173</td><td>1</td></tr><tr><th>4</th><td>2013-08-01 07:07:40</td><td>2014-08-26 00:00:31</td><td>31.2</td><td>2014-08-26</td><td>0</td><td>41.704381</td><td>-91.610258</td><td>788</td><td>0.06</td><td>9.50</td><td>2014-08-26 00:06:19</td><td>379</td><td>6.37</td><td>2014-08-26 00:09:26</td><td>566</td><td>0</td><td>173</td><td>2</td></tr></tbody></table></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 252 entries, 0 to 251
Data columns (total 18 columns):
Time                   252 non-null datetime64[ns]
Ride Time              252 non-null datetime64[ns]
Ride Time (secs)       252 non-null float64
Stopped Time           252 non-null datetime64[ns]
Stopped Time (secs)    252 non-null float64
Latitude               252 non-null float64
Longitude              252 non-null float64
Elevation (feet)       252 non-null int64
Distance (miles)       252 non-null float64
Speed (mph)            252 non-null float64
Pace                   252 non-null datetime64[ns]
Pace (secs)            252 non-null int64
Average Speed (mph)    252 non-null float64
Average Pace           252 non-null datetime64[ns]
Average Pace (secs)    252 non-null int64
Ascent (feet)          252 non-null int64
Descent (feet)         252 non-null int64
Calories               252 non-null int64
dtypes: datetime64[ns](5), float64(7), int64(6)
</code></pre><p>One minor issue is that some of the dates are parsed as <code>datetimes</code> when they&rsquo;re really just <code>times</code>.
We&rsquo;ll take care of that later. Pandas store everything as <code>datetime64</code>. For now we&rsquo;ll keep them as
<code>datetimes</code>, and remember that they&rsquo;re really just <code>times</code>.</p><p>Now let&rsquo;s do the same thing, but for all the files.</p><p>Use a generator expression to filter down to just csv&rsquo;s that match the simple
condition of having the correct naming style.
I try to use lazy generators instead of lists wherever possible.
In this case the list is so small that it really doesn&rsquo;t matter, but it&rsquo;s
a good habit.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>csvs <span style=color:#f92672>=</span> (f <span style=color:#66d9ef>for</span> f <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>listdir(<span style=color:#e6db74>&#39;data&#39;</span>) <span style=color:#66d9ef>if</span> f<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;Cyclemeter&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#f92672>and</span> f<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#39;.csv&#39;</span>))
</span></span></code></pre></div><p>I see a potential problem: We&rsquo;ll potentailly want to concatenate each csv together
into a single DataFrame. However we&rsquo;ll want to retain some idea of which specific
ride an observation came from. So let&rsquo;s create a <code>ride_id</code> variable, which will
just be an integar ranging from $0 \ldots N$, where $N$ is the number of rides.</p><p>Make a simple helper function to do this, and apply it to each csv.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>read_ride</span>(path_, i):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    read in csv at path, and assign the `ride_id` variable to i.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    date_cols <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;Time&#34;</span>, <span style=color:#e6db74>&#34;Ride Time&#34;</span>, <span style=color:#e6db74>&#34;Stopped Time&#34;</span>, <span style=color:#e6db74>&#34;Pace&#34;</span>, <span style=color:#e6db74>&#34;Average Pace&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(path_, parse_dates<span style=color:#f92672>=</span>date_cols)
</span></span><span style=display:flex><span>    df[<span style=color:#e6db74>&#39;ride_id&#39;</span>] <span style=color:#f92672>=</span> i
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> df
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>dfs <span style=color:#f92672>=</span> (read_ride(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#39;data&#39;</span>, csv), i)
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>for</span> (i, csv) <span style=color:#f92672>in</span> enumerate(csvs))
</span></span></code></pre></div><p>Now concatenate together. The original indicies are meaningless, so we&rsquo;ll ignore them in the concat.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>concat(dfs, ignore_index<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>head()
</span></span></code></pre></div><div style=max-height:1000px;max-width:1500px;overflow:auto><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>Time</th><th>Ride Time</th><th>Ride Time (secs)</th><th>Stopped Time</th><th>Stopped Time (secs)</th><th>Latitude</th><th>Longitude</th><th>Elevation (feet)</th><th>Distance (miles)</th><th>Speed (mph)</th><th>Pace</th><th>Pace (secs)</th><th>Average Speed (mph)</th><th>Average Pace</th><th>Average Pace (secs)</th><th>Ascent (feet)</th><th>Descent (feet)</th><th>Calories</th><th>ride_id</th></tr></thead><tbody><tr><th>0</th><td>2013-08-01 07:07:10</td><td>2014-08-26 00:00:01</td><td>1.1</td><td>2014-08-26</td><td>0</td><td>41.703753</td><td>-91.609892</td><td>963</td><td>0.00</td><td>2.88</td><td>2014-08-26 00:20:51</td><td>1251</td><td>0.00</td><td>2014-08-26 00:00:00</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>1</th><td>2013-08-01 07:07:17</td><td>2014-08-26 00:00:08</td><td>8.2</td><td>2014-08-26</td><td>0</td><td>41.703825</td><td>-91.609835</td><td>852</td><td>0.01</td><td>2.88</td><td>2014-08-26 00:20:51</td><td>1251</td><td>2.56</td><td>2014-08-26 00:23:27</td><td>1407</td><td>0</td><td>129</td><td>0</td><td>0</td></tr><tr><th>2</th><td>2013-08-01 07:07:22</td><td>2014-08-26 00:00:13</td><td>13.2</td><td>2014-08-26</td><td>0</td><td>41.703858</td><td>-91.609814</td><td>789</td><td>0.01</td><td>2.88</td><td>2014-08-26 00:20:51</td><td>1251</td><td>2.27</td><td>2014-08-26 00:26:27</td><td>1587</td><td>0</td><td>173</td><td>0</td><td>0</td></tr><tr><th>3</th><td>2013-08-01 07:07:27</td><td>2014-08-26 00:00:18</td><td>18.2</td><td>2014-08-26</td><td>0</td><td>41.703943</td><td>-91.610090</td><td>787</td><td>0.02</td><td>6.60</td><td>2014-08-26 00:09:06</td><td>546</td><td>4.70</td><td>2014-08-26 00:12:47</td><td>767</td><td>0</td><td>173</td><td>1</td><td>0</td></tr><tr><th>4</th><td>2013-08-01 07:07:40</td><td>2014-08-26 00:00:31</td><td>31.2</td><td>2014-08-26</td><td>0</td><td>41.704381</td><td>-91.610258</td><td>788</td><td>0.06</td><td>9.50</td><td>2014-08-26 00:06:19</td><td>379</td><td>6.37</td><td>2014-08-26 00:09:26</td><td>566</td><td>0</td><td>173</td><td>2</td><td>0</td></tr></tbody></table></div><p>Great! The data itself is clean enough that we didn&rsquo;t have to do too much munging.</p><p>Let&rsquo;s persist the merged <code>DataFrame</code>. Writing it out to a csv would be fine, but I like to use
pandas&rsquo; <code>HDF5</code> integration (via pytables) for personal projects.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df<span style=color:#f92672>.</span>to_hdf(<span style=color:#e6db74>&#39;data/cycle_store.h5&#39;</span>, key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;merged&#39;</span>,
</span></span><span style=display:flex><span>          format<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;table&#39;</span>)
</span></span></code></pre></div><p>I used the <code>table</code> format in case we want to do some querying on the HDFStore itself, but we&rsquo;ll save that for next time.</p><p>That&rsquo;s it for this post. Next time, we&rsquo;ll do some exploratry data analysis on the data.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://tomaugspurger.github.io/tags/python/>python</a></li><li><a href=https://tomaugspurger.github.io/tags/data-science/>data science</a></li><li><a href=https://tomaugspurger.github.io/tags/pandas/>pandas</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://tomaugspurger.github.io>Tom's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><a rel=me href=https://mastodon.social/@TomAugspurger></a>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>