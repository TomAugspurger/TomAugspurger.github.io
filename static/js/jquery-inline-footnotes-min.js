// jQuery Inline Footnotes v1.0.3
// Copyright (c) 2011 Vesa Vänskä, released under the MIT License.
// Generated by CoffeeScript 1.6.1
(function(){(function($){return $.inlineFootnote=function(el,options){var _this=this;return this.el=$(el),this.el.data("inlineFootnote",this),this.initialize=function(){this.options=$.extend({},$.inlineFootnote.defaultOptions,options),this.footnoteId=this.el.attr("href").match(/#(.*)/)[1];if(this.footnoteId)return this.el.mouseenter(this.openBox),$("body").mousemove(this.closeBox)},this.openBox=function(event){var footnoteContent,linkOffset;if(!_this.box)return footnoteContent=$("[id='"+_this.footnoteId+"']").children().filter(":not('"+_this.options.hideFromContent+"')"),linkOffset=_this.el.offset(),_this.box=$("<div />",{id:_this.options.boxId,html:footnoteContent.clone().find(_this.options.hideFromContent).remove().end(),css:{position:"absolute",top:linkOffset.top,left:linkOffset.left+_this.el.outerWidth()}}).appendTo("body"),_this.positionBox()},this.closeBox=function(event){if(_this.box){if(_this.isHoveringFootnote(event))return clearTimeout(_this.closeTimeout),_this.closeTimeout=null;if(!_this.closeTimeout)return _this.closeTimeout=setTimeout(function(){return _this.box.remove(),_this.box=null},_this.options.hideDelay)}},this.isHoveringFootnote=function(event){return this.box.is(event.target)||$(event.target).closest(this.box).length>0||event.target===this.el[0]},this.positionBox=function(){var boxHorizontalPadding,boxLeft,boxWidth,linkLeftOffset,windowWidth;return boxHorizontalPadding=parseInt(this.box.css("padding-left"))+parseInt(this.box.css("padding-right")),linkLeftOffset=this.el.offset().left,windowWidth=$(window).width(),windowWidth/2>linkLeftOffset?(boxLeft=linkLeftOffset+20,boxWidth=windowWidth-boxLeft-boxHorizontalPadding-this.options.boxMargin*2,boxWidth>this.options.maximumBoxWidth&&(boxWidth=this.options.maximumBoxWidth)):(boxWidth=linkLeftOffset-boxHorizontalPadding-this.options.boxMargin*2,boxWidth>this.options.maximumBoxWidth&&(boxWidth=this.options.maximumBoxWidth),boxLeft=linkLeftOffset-boxWidth-this.options.boxMargin*2),this.box.css({width:boxWidth,left:boxLeft})},this.initialize()},$.inlineFootnote.defaultOptions={boxMargin:20,hideDelay:200,hideFromContent:"[rev=footnote]",maximumBoxWidth:500,boxId:"footnote_box"},$.fn.inlineFootnote=function(options){return this.each(function(){return new $.inlineFootnote(this,options)})}})(jQuery)}).call(this);